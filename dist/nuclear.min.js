/* Nuclear
 * By AlloyTeam http://www.alloyteam.com/
 * Github: https://github.com/AlloyTeam/Nuclear
 * MIT Licensed.
 */
!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():e.Nuclear=t()}(this,function(){var e={};return e.renderList=[],e.extend=function(t){return t.ctor=function(r,n){"string"==typeof r||e.isElement(r)?(this.option=n,this.parent=document.querySelector(r),t.install&&t.install.call(this),e.observe(this.option,e.debounce(e.localRefresh,50)),e.renderList.push({tpl:this.render(),data:this.option,parent:this.parent,eventBinding:t.eventBinding,self:this}),e.render()):(this.option=r,t.install&&t.install.call(this))},e.Class.extend(t)},e.isElement=function(e){return"object"==typeof HTMLElement?e instanceof HTMLElement:e&&"object"==typeof e&&null!==e&&1===e.nodeType&&"string"==typeof e.nodeName},e.render=function(){for(var t=0,r=e.renderList.length;r>t;t++){var n=e.renderList[t];n.self.node&&n.parent.removeChild(n.self.node),n.parent.insertAdjacentHTML("beforeEnd",e.Tpl.render(n.tpl,n.data)),n.self.node=n.parent.lastChild,n.eventBinding&&n.eventBinding.call(n.self),n.refreshPart=n.self.node.querySelectorAll('*[data-nuclear-refresh="true"]')}},e.str2Dom=function(e){var t={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],body:[0,"",""],_default:[1,"<div>","</div>"]};t.optgroup=t.option,t.tbody=t.tfoot=t.colgroup=t.caption=t.thead,t.th=t.td;var r=/<\s*\w.*?>/g.exec(e),n=document.createElement("div");if(null!=r){var o=r[0].replace(/</g,"").replace(/>/g,"").split(" ")[0];if("body"===o.toLowerCase()){var i=(document.implementation.createDocument("http://www.w3.org/1999/xhtml","html",null),document.createElement("body"));n.innerHTML=e.replace(/<body/g,"<div").replace(/<\/body>/g,"</div>");var s=n.firstChild.attributes;i.innerHTML=e;for(var a=0;a<s.length;a++)i.setAttribute(s[a].name,s[a].value);return i}var n,l=t[o]||t._default;e=l[1]+e+l[2],n.innerHTML=e;for(var c=l[0]+1;c--;)n=n.lastChild}else n.innerHTML=e,n=n.lastChild;return n},e.localRefresh=function(){for(var t=0,r=e.renderList.length;r>t;t++){var n=e.renderList[t],o=n.refreshPart.length;if(o>0){for(var i=e.str2Dom(e.Tpl.render(n.tpl,n.data)).querySelectorAll('*[data-nuclear-refresh="true"]'),s=0;o>s;s++){var a=n.refreshPart[s];a.parentNode.replaceChild(i[s],a)}n.refreshPart=i}else n.self.node&&n.parent.removeChild(n.self.node),n.parent.insertAdjacentHTML("beforeEnd",e.Tpl.render(n.tpl,n.data)),n.self.node=n.parent.lastChild,n.eventBinding&&n.eventBinding.call(n.self)}},e.debounce=function(e,t,r){var n;return function(){var o=this,i=arguments,s=function(){n=null,r||e.apply(o,i)},a=r&&!n;clearTimeout(n),n=setTimeout(s,t),a&&e.apply(o,i)}},e.addEvent=function(){return function(t,r,n){if(t&&t.nodeName||t===window)t.addEventListener(r,n,!1);else if(t&&t.length)for(var o=0;o<t.length;o++)e.addEvent(t[o],r,n)}}(),e.removeEvent=function(){return function(t,r,n){if(t&&t.nodeName||t===window)t.removeEventListener(r,n,!1);else if(t&&t.length)for(var o=0;o<t.length;o++)e.removeEvent.removeEvent(t[o],r,n)}}(),e.getNodeIndex=function(e){for(var t=0;e=e.previousSibling;)3==e.nodeType&&/^\s*$/.test(e.data)||t++;return t},e.hasClass=function(e,t){return!!e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},e.addClass=function(t,r){return e.isNodeList(t)?void e._iteration("addClass",arguments):void(e.hasClass(t,r)||(t.className+=" "+r))},e.removeClass=function(t,r){if(e.isNodeList(t))return void e._iteration("removeClass",arguments);if(e.hasClass(t,r)){var n=new RegExp("(\\s|^)"+r+"(\\s|$)");t.className=t.className.replace(n," ")}},e.toggleClass=function(t,r){if(e.isNodeList(t))return void e._iteration("toggleClass",arguments);var n=" "+t.className+" ";n.indexOf(" "+e.trim(r)+" ")>=0?e.removeClass(t,r):e.addClass(t,r)},e.trim=function(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},e._iteration=function(t,r){var r=Array.prototype.slice.call(r);e.each(r[0],function(n){var o=r[0];r[0]=r[0][n],e[t].apply(e,r),r[0]=o})},e.css=function(t,r,n){return t?e.isNodeList(t)?void e._iteration("css",arguments):(3==arguments.length&&t.style&&(t.style[r]=n),window.getComputedStyle(t,null)[r]):void 0},e.each=function(e,t){for(var r=0,n=e.length;n>r;r++)t.call(e[r],r)},e.offset=function(e){var t=0,r=0;if(!document.documentElement.getBoundingClientRect||!e.getBoundingClientRect){for(;e.offsetParent;)t+=e.offsetTop,r+=e.offsetLeft,e=e.offsetParent;return{left:r,top:t}}var n=e.getBoundingClientRect();return r=n.left,t=n.top,{left:r+Math.max(document.documentElement.scrollLeft,document.body.scrollLeft),top:t+Math.max(document.documentElement.scrollTop,document.body.scrollTop)}},e.getViewport=function(){var e=document.documentElement,t=document.body,r=window,n=document.createElement("div");n.innerHTML="  <link/>";var o=3!==n.firstChild.nodeType?{left:t.scrollLeft||e.scrollLeft,top:t.scrollTop||e.scrollTop}:{left:r.pageXOffset,top:r.pageYOffset},i=r.innerWidth?{width:r.innerWidth,height:r.innerHeight}:e&&e.clientWidth&&0!=e.clientWidth?{width:e.clientWidth,height:e.clientHeight}:{width:t.clientWidth,height:t.clientHeight};return{left:o.left,top:o.top,width:i.width,height:i.height}},e.getLastNode=function(e,t){var r=e.querySelectorAll(t),n=r.length;return r[n-1]},e.isUndefined=function(e){return"undefined"==typeof e},e.domready=function(){var e,t=[],r=document,n=r.documentElement.doScroll,o="DOMContentLoaded",i=(n?/^loaded|^c/:/^loaded|^i|^c/).test(r.readyState);return i||r.addEventListener(o,e=function(){for(r.removeEventListener(o,e),i=1;e=t.shift();)e()}),function(e){i?setTimeout(e,0):t.push(e)}}(),function(){var t={},r=Object.prototype.toString;"Boolean Number String Function Array Date RegExp Object Error NodeList".split(" ").forEach(function(e){t["[object "+e+"]"]=e.toLowerCase()});var n=function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?t[r.call(e)]||"object":typeof e},o=function(e){return"nodelist"===n(e)},i=function(e){return"function"===n(e)},s=function(e){return"array"===n(e)},a=function(e){return null!=e&&e===e.window},l=function(e){return"object"!==n(e)||e.nodeType||a(e)?!1:e.constructor&&!hasOwn.call(e.constructor.prototype,"isPrototypeOf")?!1:!0};e.type=n,e.isFunction=i,e.isArray=s,e.isWindow=a,e.isPlainObject=l,e.isNodeList=o}(),e.merge=function(){var t,r,n,o,i,s,a=arguments[0]||{},l=1,c=arguments.length,u=!1;for("boolean"==typeof a&&(u=a,a=arguments[l]||{},l++),"object"==typeof a||e.isFunction(a)||(a={}),l===c&&(a=this,l--);c>l;l++)if(null!=(t=arguments[l]))for(r in t)n=a[r],o=t[r],a!==o&&(u&&o&&(e.isPlainObject(o)||(i=e.isArray(o)))?(i?(i=!1,s=n&&e.isArray(n)?n:[]):s=n&&e.isPlainObject(n)?n:{},a[r]=e.merge(u,s,o)):void 0!==o&&(a[r]=o));return a},e.uuid=function(){var e=(new Date).getTime(),t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var r=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?r:3&r|8).toString(16)});return t},function(t,r){e.Tpl={},r(e.Tpl)}(this,function(e){function t(e){return"function"==typeof e}function r(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function n(e,t){return d.call(e,t)}function o(e){return!n(v,e)}function i(e){return String(e).replace(/[&<>"'\/]/g,function(e){return g[e]})}function s(t,n){function i(){if(P&&!C)for(;g.length;)delete v[g.pop()];else g=[];P=!1,C=!1}function s(e){if("string"==typeof e&&(e=e.split(m,2)),!h(e)||2!==e.length)throw new Error("Invalid tags: "+e);u=new RegExp(r(e[0])+"\\s*"),p=new RegExp("\\s*"+r(e[1])),f=new RegExp("\\s*"+r("}"+e[1]))}if(!t)return[];var u,p,f,d=[],v=[],g=[],P=!1,C=!1;s(n||e.tags);for(var E,$,L,j,T,A,O=new c(t);!O.eos();){if(E=O.pos,L=O.scanUntil(u))for(var S=0,k=L.length;k>S;++S)j=L.charAt(S),o(j)?g.push(v.length):C=!0,v.push(["text",j,E,E+1]),E+=1,"\n"===j&&i();if(!O.scan(u))break;if(P=!0,$=O.scan(x)||"name",O.scan(y),"="===$?(L=O.scanUntil(b),O.scan(b),O.scanUntil(p)):"{"===$?(L=O.scanUntil(f),O.scan(w),O.scanUntil(p),$="&"):L=O.scanUntil(p),!O.scan(p))throw new Error("Unclosed tag at "+O.pos);if(T=[$,L,E,O.pos],v.push(T),"#"===$||"^"===$)d.push(T);else if("/"===$){if(A=d.pop(),!A)throw new Error('Unopened section "'+L+'" at '+E);if(A[1]!==L)throw new Error('Unclosed section "'+A[1]+'" at '+E)}else"name"===$||"{"===$||"&"===$?C=!0:"="===$&&s(L)}if(A=d.pop())throw new Error('Unclosed section "'+A[1]+'" at '+O.pos);return l(a(v))}function a(e){for(var t,r,n=[],o=0,i=e.length;i>o;++o)t=e[o],t&&("text"===t[0]&&r&&"text"===r[0]?(r[1]+=t[1],r[3]=t[3]):(n.push(t),r=t));return n}function l(e){for(var t,r,n=[],o=n,i=[],s=0,a=e.length;a>s;++s)switch(t=e[s],t[0]){case"#":case"^":o.push(t),i.push(t),o=t[4]=[];break;case"/":r=i.pop(),r[5]=t[2],o=i.length>0?i[i.length-1][4]:n;break;default:o.push(t)}return n}function c(e){this.string=e,this.tail=e,this.pos=0}function u(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function p(){this.cache={}}var f=Object.prototype.toString,h=Array.isArray||function(e){return"[object Array]"===f.call(e)},d=RegExp.prototype.test,v=/\S/,g={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},y=/\s*/,m=/\s+/,b=/\s*=/,w=/\s*\}/,x=/#|\^|\/|>|\{|&|=|!/;c.prototype.eos=function(){return""===this.tail},c.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var r=t[0];return this.tail=this.tail.substring(r.length),this.pos+=r.length,r},c.prototype.scanUntil=function(e){var t,r=this.tail.search(e);switch(r){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,r),this.tail=this.tail.substring(r)}return this.pos+=t.length,t},u.prototype.push=function(e){return new u(e,this)},u.prototype.lookup=function(e){var r,n=this.cache;if(e in n)r=n[e];else{for(var o,i,s=this,a=!1;s;){if(e.indexOf(".")>0)for(r=s.view,o=e.split("."),i=0;null!=r&&i<o.length;)i===o.length-1&&null!=r&&(a="object"==typeof r&&r.hasOwnProperty(o[i])),r=r[o[i++]];else null!=s.view&&"object"==typeof s.view&&(r=s.view[e],a=s.view.hasOwnProperty(e));if(a)break;s=s.parent}n[e]=r}return t(r)&&(r=r.call(this.view)),r},p.prototype.clearCache=function(){this.cache={}},p.prototype.parse=function(e,t){var r=this.cache,n=r[e];return null==n&&(n=r[e]=s(e,t)),n},p.prototype.render=function(e,t,r){var n=this.parse(e),o=t instanceof u?t:new u(t);return this.renderTokens(n,o,r,e)},p.prototype.renderTokens=function(e,t,r,n){for(var o,i,s,a="",l=0,c=e.length;c>l;++l)s=void 0,o=e[l],i=o[0],"#"===i?s=this.renderSection(o,t,r,n):"^"===i?s=this.renderInverted(o,t,r,n):">"===i?s=this.renderPartial(o,t,r,n):"&"===i?s=this.unescapedValue(o,t):"name"===i?s=this.escapedValue(o,t):"text"===i&&(s=this.rawValue(o)),void 0!==s&&(a+=s);return a},p.prototype.renderSection=function(e,r,n,o){function i(e){return s.render(e,r,n)}var s=this,a="",l=r.lookup(e[1]);if(l){if(h(l))for(var c=0,u=l.length;u>c;++c)a+=this.renderTokens(e[4],r.push(l[c]),n,o);else if("object"==typeof l||"string"==typeof l||"number"==typeof l)a+=this.renderTokens(e[4],r.push(l),n,o);else if(t(l)){if("string"!=typeof o)throw new Error("Cannot use higher-order sections without the original template");l=l.call(r.view,o.slice(e[3],e[5]),i),null!=l&&(a+=l)}else a+=this.renderTokens(e[4],r,n,o);return a}},p.prototype.renderInverted=function(e,t,r,n){var o=t.lookup(e[1]);return!o||h(o)&&0===o.length?this.renderTokens(e[4],t,r,n):void 0},p.prototype.renderPartial=function(e,r,n){if(n){var o=t(n)?n(e[1]):n[e[1]];return null!=o?this.renderTokens(this.parse(o),r,n,o):void 0}},p.prototype.unescapedValue=function(e,t){var r=t.lookup(e[1]);return null!=r?r:void 0},p.prototype.escapedValue=function(t,r){var n=r.lookup(t[1]);return null!=n?e.escape(n):void 0},p.prototype.rawValue=function(e){return e[1]},e.name="mustache.js",e.version="2.0.0",e.tags=["{{","}}"];var P=new p;e.clearCache=function(){return P.clearCache()},e.parse=function(e,t){return P.parse(e,t)},e.render=function(e,t,r){return P.render(e,t,r)},e.to_html=function(r,n,o,i){var s=e.render(r,n,o);return t(i)?void i(s):s},e.escape=i,e.Scanner=c,e.Context=u,e.Writer=p}),function(){var t=function(e,r,n){var o=function(e,r,n){e.$observer||(e.$observer=this);var o=e.$observer,i=[];t.isArray(e)&&(0===e.length&&(e.$observeProps={},e.$observeProps.$observerPath="#"),o.mock(e));for(var s in e)e.hasOwnProperty(s)&&(n?t.isArray(r)&&t.isInArray(r,s)?(i.push(s),o.watch(e,s)):t.isString(r)&&s==r&&(i.push(s),o.watch(e,s)):(i.push(s),o.watch(e,s)));o.target=e,o.propertyChangedHandler||(o.propertyChangedHandler=[]);var a=n?n:r;o.propertyChangedHandler.push({all:!n,propChanged:a,eventPropArr:i})};return o.prototype={onPropertyChanged:function(e,r,n,o,i){if(r!==n&&this.propertyChangedHandler)for(var s=t._getRootName(e,i),a=0,l=this.propertyChangedHandler.length;l>a;a++){var c=this.propertyChangedHandler[a];(c.all||t.isInArray(c.eventPropArr,s)||0===s.indexOf("Array-"))&&c.propChanged.call(this.target,e,r,n,i)}0!==e.indexOf("Array-")&&"object"==typeof r&&this.watch(o,e,o.$observeProps.$observerPath)},mock:function(e){var r=this;t.methods.forEach(function(n){e[n]=function(){var e=Array.prototype.slice.call(this,0),o=Array.prototype[n].apply(this,Array.prototype.slice.call(arguments));if(new RegExp("\\b"+n+"\\b").test(t.triggerStr)){for(var i in this)this.hasOwnProperty(i)&&!t.isFunction(this[i])&&r.watch(this,i,this.$observeProps.$observerPath);r.onPropertyChanged("Array-"+n,this,e,this,this.$observeProps.$observerPath)}return o}})},watch:function(e,r,n){if("$observeProps"!==r&&"$observer"!==r&&!t.isFunction(e[r])){e.$observeProps||(e.$observeProps={}),e.$observeProps.$observerPath=void 0!==n?n:"#";var o=this,i=e.$observeProps[r]=e[r];if(Object.defineProperty(e,r,{get:function(){return this.$observeProps[r]},set:function(t){var n=this.$observeProps[r];this.$observeProps[r]=t,o.onPropertyChanged(r,t,n,this,e.$observeProps.$observerPath)}}),"object"==typeof i){t.isArray(i)&&(this.mock(i),0===i.length&&(i.$observeProps||(i.$observeProps={}),i.$observeProps.$observerPath=void 0!==n?n:"#"));for(var s in i)i.hasOwnProperty(s)&&this.watch(i,s,e.$observeProps.$observerPath+"-"+r)}}}},new o(e,r,n)};t.methods=["concat","every","filter","forEach","indexOf","join","lastIndexOf","map","pop","push","reduce","reduceRight","reverse","shift","slice","some","sort","splice","unshift","toLocaleString","toString","size"],t.triggerStr=["concat","pop","push","reverse","shift","sort","splice","unshift","size"].join(","),t.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},t.isString=function(e){return"string"==typeof e},t.isInArray=function(e,t){for(var r=e.length;--r>-1;)if(t===e[r])return!0;return!1},t.isFunction=function(e){return"[object Function]"==Object.prototype.toString.call(e)},t.twoWay=function(e,r,n,o){"object"==typeof e[r]&&"object"==typeof n[o]?(t(e,r,function(e,t){n[o]=this[r]}),t(n,o,function(t,n){e[r]=this[o]})):(t(e,r,function(e,t){n[o]=t}),t(n,o,function(t,n){e[r]=n}))},t._getRootName=function(e,t){return"#"===t?e:t.split("-")[1]},t.add=function(e,t,r){e[t]=r;var n=e.$observer;n.watch(e,t)},Array.prototype.size=function(e){this.length=e},e.observe=t}(),function(){var t=!1,r=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/,n=function(){};n.extend=function(e){function o(){!t&&this.ctor&&this.ctor.apply(this,arguments)}var i=this.prototype;t=!0;var s=new this;t=!1;for(var a in e)"statics"!=a&&(s[a]="function"==typeof e[a]&&"function"==typeof i[a]&&r.test(e[a])?function(e,t){return function(){var r=this._super;this._super=i[e];var n=t.apply(this,arguments);return this._super=r,n}}(a,e[a]):e[a]);for(var l in this)this.hasOwnProperty(l)&&"extend"!=l&&(o[l]=this[l]);if(o.prototype=s,e.statics)for(var a in e.statics)e.statics.hasOwnProperty(a)&&(o[a]=e.statics[a],"ctor"==a&&o[a]());return o.prototype.constructor=o,o.extend=n.extend,o.implement=function(e){for(var t in e)s[t]=e[t]},o},e.Class=n}(),e});