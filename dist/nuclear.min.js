/* Nuclear
 * By AlloyTeam http://www.alloyteam.com/
 * Github: https://github.com/AlloyTeam/Nuclear
 * MIT Licensed.
 */
!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():"function"==typeof define&&define.cmd&&define(function(e,n,r){r.exports=t()}),e.Nuclear=t()}(window,function(){(function(){"use strict";function e(e,t,n){!function(r){e[t]=e[n],e[n]=r}(e[t])}var t,n=function(e){var t=this;Object.keys(e).forEach(function(n){t[n]=e[n]})};n.prototype={toString:function(){return JSON.stringify(this)}};var r=function(e,t){this.oldValue=e,this.newValue=t};r.prototype={contains:function(e){return e.length<this.length?e.newValue>=this.newValue&&e.newValue<this.newValue+this.length:!1},toString:function(){return this.length+" element subset, first mapping: old "+this.oldValue+" â†’ new "+this.newValue}};var o=function(e){var t=[];return"#text"!==e.nodeName&&"#comment"!==e.nodeName&&(t.push(e.nodeName),e.attributes&&(e.attributes["class"]&&t.push(e.nodeName+"."+e.attributes["class"].replace(/ /g,".")),e.attributes.id&&t.push(e.nodeName+"#"+e.attributes.id))),t},i=function(e){var t={},n={};return e.forEach(function(e){o(e).forEach(function(e){var r=e in t,o=e in n;r||o?r&&(delete t[e],n[e]=!0):t[e]=!0})}),t},a=function(e,t){var n=i(e),r=i(t),o={};return Object.keys(n).forEach(function(e){r[e]&&(o[e]=!0)}),o},s=function(e){return delete e.outerDone,delete e.innerDone,delete e.valueDone,e.childNodes?e.childNodes.every(s):!0},l=function(e,t){var n,r;if(!["nodeName","value","checked","selected","data"].every(function(n){return e[n]===t[n]}))return!1;if(Boolean(e.attributes)!==Boolean(t.attributes))return!1;if(Boolean(e.childNodes)!==Boolean(t.childNodes))return!1;if(e.attributes){if(n=Object.keys(e.attributes),r=Object.keys(t.attributes),n.length!==r.length)return!1;if(!n.every(function(n){return e.attributes[n]!==t.attributes[n]?!1:void 0}))return!1}if(e.childNodes){if(e.childNodes.length!==t.childNodes.length)return!1;if(!e.childNodes.every(function(e,n){return l(e,t.childNodes[n])}))return!1}return!0},c=function(e,t,n,r,o){var i,s,l;if(!e||!t)return!1;if(e.nodeName!==t.nodeName)return!1;if("#text"===e.nodeName)return o?!0:e.data===t.data;if(e.nodeName in n)return!0;if(e.attributes&&t.attributes){if(e.attributes.id&&e.attributes.id===t.attributes.id){var u=e.nodeName+"#"+e.attributes.id;if(u in n)return!0}if(e.attributes["class"]&&e.attributes["class"]===t.attributes["class"]){var d=e.nodeName+"."+e.attributes["class"].replace(/ /g,".");if(d in n)return!0}}return r?!0:(s=e.childNodes?e.childNodes.slice().reverse():[],l=t.childNodes?t.childNodes.slice().reverse():[],s.length!==l.length?!1:o?s.every(function(e,t){return e.nodeName===l[t].nodeName}):(i=a(s,l),s.every(function(e,t){return c(e,l[t],i,!0,!0)})))},u=function(e){return JSON.parse(JSON.stringify(e))},d=function(e,t,n,i){var s,l,u=0,d=[],h=Array.apply(null,new Array(e.length+1)).map(function(){return[]}),f=a(e,t),p=e.length===t.length;return p&&e.some(function(e,n){var r=o(e),i=o(t[n]);return r.length!==i.length?(p=!1,!0):(r.some(function(e,t){return e!==i[t]?(p=!1,!0):void 0}),p?void 0:!0)}),e.forEach(function(e,r){t.forEach(function(t,o){n[r]||i[o]||!c(e,t,f,p)?h[r+1][o+1]=0:(h[r+1][o+1]=h[r][o]?h[r][o]+1:1,h[r+1][o+1]>=u&&(u=h[r+1][o+1],d=[r+1,o+1]))})}),0===u?!1:(s=[d[0]-u,d[1]-u],l=new r(s[0],s[1]),l.length=u,l)},h=function(e,t){return Array.apply(null,new Array(e)).map(function(){return t})},f=function(e,t,n){var r=e.childNodes?h(e.childNodes.length,!0):[],o=t.childNodes?h(t.childNodes.length,!0):[],i=0;return n.forEach(function(e){var t,n=e.oldValue+e.length,a=e.newValue+e.length;for(t=e.oldValue;n>t;t+=1)r[t]=i;for(t=e.newValue;a>t;t+=1)o[t]=i;i+=1}),{gaps1:r,gaps2:o}},p=function(e,t){for(var n=e.childNodes?e.childNodes:[],r=t.childNodes?t.childNodes:[],o=h(n.length,!1),i=h(r.length,!1),a=[],s=!0,l=function(){return arguments[1]},c=function(e){o[s.oldValue+e]=!0,i[s.newValue+e]=!0};s;)s=d(n,r,o,i),s&&(a.push(s),Array.apply(null,new Array(s.length)).map(l).forEach(c));return a},m=function(){this.list=[]};m.prototype={list:!1,add:function(e){var t=this.list;e.forEach(function(e){t.push(e)})},forEach:function(e){this.list.forEach(e)}};var v=function(e){var t,n={debug:!1,diffcap:10,maxDepth:!1,valueDiffing:!0,textDiff:function(){arguments[0].data=arguments[3]},preVirtualDiffApply:function(){},postVirtualDiffApply:function(){},preDiffApply:function(){},postDiffApply:function(){}};"undefined"==typeof e&&(e={});for(t in n)"undefined"==typeof e[t]?this[t]=n[t]:this[t]=e[t]};v.prototype={diff:function(e,n){var r=this.nodeToObj(e),o=this.nodeToObj(n);return t=0,this.debug&&(this.t1Orig=this.nodeToObj(e),this.t2Orig=this.nodeToObj(n)),this.tracker=new m,this.findDiffs(r,o)},findDiffs:function(e,n){var r;do{if(this.debug&&(t+=1,t>this.diffcap))throw window.diffError=[this.t1Orig,this.t2Orig],new Error("surpassed diffcap:"+JSON.stringify(this.t1Orig)+" -> "+JSON.stringify(this.t2Orig));r=this.findNextDiff(e,n,[]),0===r.length&&(l(e,n)||(s(e),r=this.findNextDiff(e,n,[]))),r.length>0&&(this.tracker.add(r),this.applyVirtual(e,r))}while(r.length>0);return this.tracker.list},findNextDiff:function(e,t,n){var r;if(this.maxDepth&&n.length>this.maxDepth)return[];if(!e.outerDone){if(r=this.findOuterDiff(e,t,n),r.length>0)return e.outerDone=!0,r;e.outerDone=!0}if(!e.innerDone){if(r=this.findInnerDiff(e,t,n),r.length>0)return r;e.innerDone=!0}if(this.valueDiffing&&!e.valueDone){if(r=this.findValueDiff(e,t,n),r.length>0)return e.valueDone=!0,r;e.valueDone=!0}return[]},findOuterDiff:function(e,t,r){var o,i,a=[];return e.nodeName!==t.nodeName?[new n({action:"replaceElement",oldValue:u(e),newValue:u(t),route:r})]:e.data!==t.data?"#text"===e.nodeName?[new n({action:"modifyComment",route:r,oldValue:e.data,newValue:t.data})]:[new n({action:"modifyTextElement",route:r,oldValue:e.data,newValue:t.data})]:(o=e.attributes?Object.keys(e.attributes).sort():[],i=t.attributes?Object.keys(t.attributes).sort():[],o.forEach(function(o){var s=i.indexOf(o);-1===s?a.push(new n({action:"removeAttribute",route:r,name:o,value:e.attributes[o]})):(i.splice(s,1),e.attributes[o]!==t.attributes[o]&&a.push(new n({action:"modifyAttribute",route:r,name:o,oldValue:e.attributes[o],newValue:t.attributes[o]})))}),i.forEach(function(e){a.push(new n({action:"addAttribute",route:r,name:e,value:t.attributes[e]}))}),a)},nodeToObj:function(e){var t={},n=this;return t.nodeName=e.nodeName,"#text"===t.nodeName||"#comment"===t.nodeName?t.data=e.data:(e.attributes&&e.attributes.length>0&&(t.attributes={},Array.prototype.slice.call(e.attributes).forEach(function(e){t.attributes[e.name]=e.value})),e.childNodes&&e.childNodes.length>0&&(t.childNodes=[],Array.prototype.slice.call(e.childNodes).forEach(function(e){t.childNodes.push(n.nodeToObj(e))})),this.valueDiffing&&(void 0!==e.value&&(t.value=e.value),void 0!==e.checked&&(t.checked=e.checked),void 0!==e.selected&&(t.selected=e.selected))),t},objToNode:function(e,t){var n,r=this;return"#text"===e.nodeName?n=document.createTextNode(e.data):"#comment"===e.nodeName?n=document.createComment(e.data):("svg"===e.nodeName||t?(n=document.createElementNS("http://www.w3.org/2000/svg",e.nodeName),t=!0):n=document.createElement(e.nodeName),e.attributes&&Object.keys(e.attributes).forEach(function(t){'=""'!==t&&n.setAttribute(t,e.attributes[t])}),e.childNodes&&e.childNodes.forEach(function(e){n.appendChild(r.objToNode(e,t))}),this.valueDiffing&&(e.value&&(n.value=e.value),e.checked&&(n.checked=e.checked),e.selected&&(n.selected=e.selected))),n},findInnerDiff:function(e,t,r){var o,i,a,s,l,c=e.childNodes&&t.childNodes?p(e,t):[],d=e.childNodes?e.childNodes:[],h=t.childNodes?t.childNodes:[],f=[],m=0;if(c.length>1)return this.attemptGroupRelocation(e,t,c,r);for(i=Math.max(d.length,h.length),d.length!==h.length&&(o=!0),l=0;i>l;l+=1)a=d[l],s=h[l],o&&(a&&!s?"#text"===a.nodeName?(f.push(new n({action:"removeTextElement",route:r.concat(m),value:a.data})),m-=1):(f.push(new n({action:"removeElement",route:r.concat(m),element:u(a)})),m-=1):s&&!a&&("#text"===s.nodeName?f.push(new n({action:"addTextElement",route:r.concat(m),value:s.data})):f.push(new n({action:"addElement",route:r.concat(m),element:u(s)})))),a&&s&&(f=f.concat(this.findNextDiff(a,s,r.concat(m)))),m+=1;return e.innerDone=!0,f},attemptGroupRelocation:function(e,t,r,o){var i,a,s,l,d,h,p,m,v,y=f(e,t,r),b=y.gaps1,g=y.gaps2,w=Math.min(b.length,g.length),N=[];for(m=0,p=0;w>m;p+=1,m+=1)if(b[m]===!0)if(l=e.childNodes[p],"#text"===l.nodeName){if("#text"===t.childNodes[m].nodeName&&l.data!==t.childNodes[m].data){for(h=p;e.childNodes.length>h+1&&"#text"===e.childNodes[h+1].nodeName;)if(h+=1,t.childNodes[m].data===e.childNodes[h].data){d=!0;break}d||N.push(new n({action:"modifyTextElement",route:o.concat(m),oldValue:l.data,newValue:t.childNodes[m].data}))}N.push(new n({action:"removeTextElement",route:o.concat(m),value:l.data})),b.splice(m,1),w=Math.min(b.length,g.length),m-=1}else N.push(new n({action:"removeElement",route:o.concat(m),element:u(l)})),b.splice(m,1),w=Math.min(b.length,g.length),m-=1;else if(g[m]===!0)l=t.childNodes[m],"#text"===l.nodeName?(N.push(new n({action:"addTextElement",route:o.concat(m),value:l.data})),b.splice(m,0,!0),w=Math.min(b.length,g.length),p-=1):(N.push(new n({action:"addElement",route:o.concat(m),element:u(l)})),b.splice(m,0,!0),w=Math.min(b.length,g.length),p-=1);else if(b[m]!==g[m]){if(N.length>0)return N;if(s=r[b[m]],a=Math.min(s.newValue,e.childNodes.length-s.length),a!==s.oldValue){for(i=!1,v=0;v<s.length;v+=1)c(e.childNodes[a+v],e.childNodes[s.oldValue+v],[],!1,!0)||(i=!0);if(i)return[new n({action:"relocateGroup",groupLength:s.length,from:s.oldValue,to:a,route:o})]}}return N},findValueDiff:function(e,t,r){var o=[];return e.selected!==t.selected&&o.push(new n({action:"modifySelected",oldValue:e.selected,newValue:t.selected,route:r})),(e.value||t.value)&&e.value!==t.value&&"OPTION"!==e.nodeName&&o.push(new n({action:"modifyValue",oldValue:e.value,newValue:t.value,route:r})),e.checked!==t.checked&&o.push(new n({action:"modifyChecked",oldValue:e.checked,newValue:t.checked,route:r})),o},applyVirtual:function(e,t){var n=this;return 0===t.length?!0:(t.forEach(function(t){n.applyVirtualDiff(e,t)}),!0)},getFromVirtualRoute:function(e,t){var n,r,o=e;for(t=t.slice();t.length>0;){if(!o.childNodes)return!1;r=t.splice(0,1)[0],n=o,o=o.childNodes[r]}return{node:o,parentNode:n,nodeIndex:r}},applyVirtualDiff:function(e,t){var n,r,o,i=this.getFromVirtualRoute(e,t.route),a=i.node,s=i.parentNode,l=i.nodeIndex,c={diff:t,node:a};if(this.preVirtualDiffApply(c))return!0;switch(t.action){case"addAttribute":a.attributes||(a.attributes={}),a.attributes[t.name]=t.value,"checked"===t.name?a.checked=!0:"selected"===t.name?a.selected=!0:"INPUT"===a.nodeName&&"value"===t.name&&(a.value=t.value);break;case"modifyAttribute":a.attributes[t.name]=t.newValue,"INPUT"===a.nodeName&&"value"===t.name&&(a.value=t.value);break;case"removeAttribute":delete a.attributes[t.name],0===Object.keys(a.attributes).length&&delete a.attributes,"checked"===t.name?delete a.checked:"selected"===t.name?delete a.selected:"INPUT"===a.nodeName&&"value"===t.name&&delete a.value;break;case"modifyTextElement":a.data=t.newValue,"TEXTAREA"===s.nodeName&&(s.value=t.newValue);break;case"modifyValue":a.value=t.newValue;break;case"modifyComment":a.data=t.newValue;break;case"modifyChecked":a.checked=t.newValue;break;case"modifySelected":a.selected=t.newValue;break;case"replaceElement":n=u(t.newValue),n.outerDone=!0,n.innerDone=!0,n.valueDone=!0,s.childNodes[l]=n;break;case"relocateGroup":a.childNodes.splice(t.from,t.groupLength).reverse().forEach(function(e){a.childNodes.splice(t.to,0,e)});break;case"removeElement":s.childNodes.splice(l,1);break;case"addElement":r=t.route.slice(),o=r.splice(r.length-1,1)[0],a=this.getFromVirtualRoute(e,r).node,n=u(t.element),n.outerDone=!0,n.innerDone=!0,n.valueDone=!0,a.childNodes||(a.childNodes=[]),o>=a.childNodes.length?a.childNodes.push(n):a.childNodes.splice(o,0,n);break;case"removeTextElement":s.childNodes.splice(l,1),"TEXTAREA"===s.nodeName&&delete s.value;break;case"addTextElement":r=t.route.slice(),o=r.splice(r.length-1,1)[0],n={},n.nodeName="#text",n.data=t.value,a=this.getFromVirtualRoute(e,r).node,a.childNodes||(a.childNodes=[]),o>=a.childNodes.length?a.childNodes.push(n):a.childNodes.splice(o,0,n),"TEXTAREA"===a.nodeName&&(a.value=t.newValue);break;default:console.log("unknown action")}c.newNode=n,this.postVirtualDiffApply(c)},apply:function(e,t){var n=this;return 0===t.length?!0:(t.forEach(function(t){return n.applyDiff(e,t)?void 0:!1}),!0)},getFromRoute:function(e,t){t=t.slice();for(var n,r=e;t.length>0;){if(!r.childNodes)return!1;n=t.splice(0,1)[0],r=r.childNodes[n]}return r},applyDiff:function(e,t){var n,r,o,i,a=this.getFromRoute(e,t.route),s={diff:t,node:a};if(this.preDiffApply(s))return!0;switch(t.action){case"addAttribute":if(!a||!a.setAttribute)return!1;if('"'===t.name||'="'===t.name||'=""'===t.name)break;a.setAttribute(t.name,t.value);break;case"modifyAttribute":if(!a||!a.setAttribute)return!1;a.setAttribute(t.name,t.newValue);break;case"removeAttribute":if(!a||!a.removeAttribute)return!1;a.removeAttribute(t.name);break;case"modifyTextElement":if(!a||3!==a.nodeType)return!1;this.textDiff(a,a.data,t.oldValue,t.newValue);break;case"modifyValue":if(!a||"undefined"==typeof a.value)return!1;a.value=t.newValue;break;case"modifyComment":if(!a||"undefined"==typeof a.data)return!1;this.textDiff(a,a.data,t.oldValue,t.newValue);break;case"modifyChecked":if(!a||"undefined"==typeof a.checked)return!1;a.checked=t.newValue;break;case"modifySelected":if(!a||"undefined"==typeof a.selected)return!1;a.selected=t.newValue;break;case"replaceElement":a.parentNode.replaceChild(this.objToNode(t.newValue,"http://www.w3.org/2000/svg"===a.namespaceURI),a);break;case"relocateGroup":Array.apply(null,new Array(t.groupLength)).map(function(){return a.removeChild(a.childNodes[t.from])}).forEach(function(e,n){0===n&&(r=a.childNodes[t.to]),a.insertBefore(e,r)});break;case"removeElement":a.parentNode.removeChild(a);break;case"addElement":o=t.route.slice(),i=o.splice(o.length-1,1)[0],a=this.getFromRoute(e,o),a.insertBefore(this.objToNode(t.element,"http://www.w3.org/2000/svg"===a.namespaceURI),a.childNodes[i]);break;case"removeTextElement":if(!a||3!==a.nodeType)return!1;a.parentNode.removeChild(a);break;case"addTextElement":if(o=t.route.slice(),i=o.splice(o.length-1,1)[0],n=document.createTextNode(t.value),a=this.getFromRoute(e,o),!a||!a.childNodes)return!1;a.insertBefore(n,a.childNodes[i]);break;default:console.log("unknown action")}return s.newNode=n,this.postDiffApply(s),!0},undo:function(e,t){t=t.slice();var n=this;t.length||(t=[t]),t.reverse(),t.forEach(function(t){n.undoDiff(e,t)})},undoDiff:function(t,n){switch(n.action){case"addAttribute":n.action="removeAttribute",this.applyDiff(t,n);break;case"modifyAttribute":e(n,"oldValue","newValue"),this.applyDiff(t,n);break;case"removeAttribute":n.action="addAttribute",this.applyDiff(t,n);break;case"modifyTextElement":e(n,"oldValue","newValue"),this.applyDiff(t,n);break;case"modifyValue":e(n,"oldValue","newValue"),this.applyDiff(t,n);break;case"modifyComment":e(n,"oldValue","newValue"),this.applyDiff(t,n);break;case"modifyChecked":e(n,"oldValue","newValue"),this.applyDiff(t,n);break;case"modifySelected":e(n,"oldValue","newValue"),this.applyDiff(t,n);break;case"replaceElement":e(n,"oldValue","newValue"),this.applyDiff(t,n);break;case"relocateGroup":e(n,"from","to"),this.applyDiff(t,n);break;case"removeElement":n.action="addElement",this.applyDiff(t,n);break;case"addElement":n.action="removeElement",this.applyDiff(t,n);break;case"removeTextElement":n.action="addTextElement",this.applyDiff(t,n);break;case"addTextElement":n.action="removeTextElement",this.applyDiff(t,n);break;default:console.log("unknown action")}}},"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=v),exports.diffDOM=v):window.diffDOM=v}).call(this);var e={};return e.diffDOM=new diffDOM,e.create=function(t,n){t._nuclearSetting=n,e._mixObj(t);var r=this===e?e.Class:this,o=r.extend(t);return o.create=e.create,o},e._mixObj=function(t){t.ctor=function(t,n){if(this._ncInstanceId=e.getInstanceId(),this._nuclearTwoWay=!0,this._nuclearDiffDom=!0,this._nuclearSetting&&(this._nuclearSetting.twoWay===!1&&(this._nuclearTwoWay=!1),this._nuclearSetting.diff===!1&&(this._nuclearDiffDom=!1)),window.Nuclear.instances[this._ncInstanceId]=this,this._nuclearParentEmpty=!n,this.HTML="",this.option=t,this._nuclearParentEmpty)this.parent=document.createElement("div");else if(this.parent="string"==typeof n?document.querySelector(n):n,document.body!==this.parent)for(;this.parent.firstChild;)this.parent.removeChild(this.parent.firstChild);this.install&&this.install(),this._nuclearRef=[];for(var r in this)this.hasOwnProperty(r)&&this[r]&&this[r]._nuclearLocalRefresh&&(this[r]._nuclearParent=this,this._nuclearRef.push(this[r]));this._nuclearTimer=null,this._preNuclearTime=new Date,this.option&&this._nuclearTwoWay&&e.observe(this.option,function(e,t,n,r){(!this.onOptionChange||this.onOptionChange&&this.onOptionChange(e,t,n,r)!==!1)&&(clearTimeout(this._nuclearTimer),new Date-this._preNuclearTime>40?(this._nuclearLocalRefresh(),this._preNuclearTime=new Date):this._nuclearTimer=setTimeout(function(){this._nuclearLocalRefresh()}.bind(this),40))}.bind(this)),this._nuclearRenderInfo={tpl:this._nuclearTplGenerator(),data:this.option,parent:this.parent},this._nuclearRender(this._nuclearRenderInfo),this.installed&&this.installed()},t.refresh=function(){this._nuclearLocalRefresh()},t.render&&(t._nuclearTplGenerator=t.render),t.render=function(){return this._nuclearParentEmpty?this.HTML:this._nuclearTplGenerator()},t._nuclearRender=function(t){if(this.node)if(e.isUndefined(t.tpl))t.parent.removeChild(this.node),this.node=null,this.HTML="";else{var n=e.str2Dom(this._nuclearWrap(e.render(e._fixEvent(e._fixTplIndex(t.tpl),this._ncInstanceId),t.data)));this._nuclearDiffDom?e.diffDOM.apply(this.node,e.diffDOM.diff(this.node,n)):(t.parent.replaceChild(n,this.node),this.node=n)}else e.isUndefined(t.tpl)||(t.parent.insertAdjacentHTML("beforeEnd",this._nuclearWrap(e.render(e._fixEvent(e._fixTplIndex(t.tpl),this._ncInstanceId),t.data))),this.node=t.parent.lastChild);this.node&&(this._nuclearId=e.getId(),this.node.setAttribute("data-nuclearId",this._nuclearId),this._mixNode(),t.refreshPart=this.node.querySelectorAll("*[nc-refresh]"),this.HTML=this.node.outerHTML,this._nuclearFix(),this.onRefresh&&this.onRefresh())},t._mixNode=function(){var e=this.node.querySelectorAll("*[nc-id]"),t=e.length;if(t>0)for(var n=0;t>n;n++){var r=e[n];this[r.getAttribute("nc-id")]=r}var o=this.node.querySelectorAll("*[nc-class]"),i=o.length;if(i>0){for(var a=0;i>a;a++){var s=o[a],l=s.getAttribute("nc-class");this[l]=[]}for(a=0;i>a;a++){var s=o[a],l=s.getAttribute("nc-class");this[l].push(s)}}},t._nuclearFix=function(){this._nuclearParent||this._nuclearFixOne(this)},t._nuclearFixOne=function(e){var t=e._nuclearRef.length;if(t>0)for(var n=0;t>n;n++){var r=e._nuclearRef[n];r.node=e.node.querySelector('*[data-nuclearId="'+r._nuclearId+'"]'),r.node&&(r._mixNode(),r._nuclearRenderInfo.refreshPart=r.node.querySelectorAll("*[nc-refresh]"),r._nuclearRenderInfo.parent=r.node.parentNode,this._nuclearFixOne(r),r.onRefresh&&r.onRefresh(),r.installed&&r.installed())}},t._nuclearWrap=function(e){var t="";return this.style&&(t="<style scoped>"+this.style()+"</style>"),"<div>"+e+t+"</div>"},t._nuclearLocalRefresh=function(){var t=this._nuclearRenderInfo,n=t.refreshPart.length;if(t.tpl=this._nuclearTplGenerator(),n>0){for(var r=e.str2Dom(this._nuclearWrap(e.render(e._fixEvent(e._fixTplIndex(t.tpl),this._ncInstanceId),t.data))).querySelectorAll("*[nc-refresh]"),o=0;n>o;o++){var i=t.refreshPart[o];i.parentNode&&i.parentNode.replaceChild(r[o],i)}t.refreshPart=r,this._mixNode(),this.HTML=this.node.outerHTML,this._nuclearFix(),this.onRefresh&&this.onRefresh()}else this._nuclearRender(t);e.refreshStyle()}},e._fixEvent=function(e,t){return e.replace(/<[\s\S]*?>/g,function(e){return e.replace(/(onabort|onblur|oncancel|oncanplay|oncanplaythrough|onchange|onclick|onclose|oncontextmenu|oncuechange|ondblclick|ondrag|ondragend|ondragenter|ondragleave|ondragover|ondragstart|ondrop|ondurationchange|onemptied|onended|onerror|onfocus|oninput|oninvalid|onkeydown|onkeypress|onkeyup|onload|onloadeddata|onloadedmetadata|onloadstart|onmousedown|onmouseenter|onmouseleave|onmousemove|onmouseout|onmouseover|onmouseup|onmousewheel|onpause|onplay|onplaying|onprogress|onratechange|onreset|onresize|onscroll|onseeked|onseeking|onselect|onshow|onstalled|onsubmit|onsuspend|ontimeupdate|ontoggle|onvolumechange|onwaiting|onautocomplete|onautocompleteerror|onbeforecopy|onbeforecut|onbeforepaste|oncopy|oncut|onpaste|onsearch|onselectstart|onwheel|onwebkitfullscreenchange|onwebkitfullscreenerror)=('|")/g,function(e,n,r,o,i){return"Nuclear.instances["===i.substr(e.length+o,18)?e:e+="Nuclear.instances["+t+"]."})})},e._fixTplIndex=function(e){return e.replace(/{{@index}}/g,"{{_nuclearIndex}}")},e.str2Dom=function(e){var t={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],body:[0,"",""],_default:[1,"<div>","</div>"]};t.optgroup=t.option,t.tbody=t.tfoot=t.colgroup=t.caption=t.thead,t.th=t.td;var n=/<\s*\w.*?>/g.exec(e),r=document.createElement("div");if(null!=n){var o=n[0].replace(/</g,"").replace(/>/g,"").split(" ")[0];if("body"===o.toLowerCase()){var i=document.createElement("body");r.innerHTML=e.replace(/<body/g,"<div").replace(/<\/body>/g,"</div>");var a=r.firstChild.attributes;i.innerHTML=e;for(var s=0;s<a.length;s++)i.setAttribute(a[s].name,a[s].value);return i}var l=t[o]||t._default;e=l[1]+e+l[2],r.innerHTML=e;for(var c=l[0]+1;c--;)r=r.lastChild}else r.innerHTML=e,r=r.lastChild;return r},e.isUndefined=function(e){return"undefined"==typeof e},e._nextID=0,e.getId=function(){return e._nextID++},e._instanceId=0,e.getInstanceId=function(){return e._instanceId++},e.instances={},function(t,n){e.Tpl={},n(e.Tpl),e.render=e.Tpl.render}(this,function(e){function t(e){return"function"==typeof e}function n(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function r(e,t){return p.call(e,t)}function o(e){return!r(m,e)}function i(e){return String(e).replace(/[&<>"'\/]/g,function(e){return v[e]})}function a(t,r){function i(){if(k&&!x)for(;v.length;)delete m[v.pop()];else v=[];k=!1,x=!1}function a(e){if("string"==typeof e&&(e=e.split(b,2)),!f(e)||2!==e.length)throw new Error("Invalid tags: "+e);u=new RegExp(n(e[0])+"\\s*"),d=new RegExp("\\s*"+n(e[1])),h=new RegExp("\\s*"+n("}"+e[1]))}if(!t)return[];var u,d,h,p=[],m=[],v=[],k=!1,x=!1;a(r||e.tags);for(var E,D,V,T,_,A,O=new c(t);!O.eos();){if(E=O.pos,V=O.scanUntil(u))for(var P=0,C=V.length;C>P;++P)T=V.charAt(P),o(T)?v.push(m.length):x=!0,m.push(["text",T,E,E+1]),E+=1,"\n"===T&&i();if(!O.scan(u))break;if(k=!0,D=O.scan(N)||"name",O.scan(y),"="===D?(V=O.scanUntil(g),O.scan(g),O.scanUntil(d)):"{"===D?(V=O.scanUntil(h),O.scan(w),O.scanUntil(d),D="&"):V=O.scanUntil(d),!O.scan(d))throw new Error("Unclosed tag at "+O.pos);if(_=[D,V,E,O.pos],m.push(_),"#"===D||"^"===D)p.push(_);else if("/"===D){if(A=p.pop(),!A)throw new Error('Unopened section "'+V+'" at '+E);if(A[1]!==V)throw new Error('Unclosed section "'+A[1]+'" at '+E)}else"name"===D||"{"===D||"&"===D?x=!0:"="===D&&a(V)}if(A=p.pop())throw new Error('Unclosed section "'+A[1]+'" at '+O.pos);return l(s(m))}function s(e){for(var t,n,r=[],o=0,i=e.length;i>o;++o)t=e[o],t&&("text"===t[0]&&n&&"text"===n[0]?(n[1]+=t[1],n[3]=t[3]):(r.push(t),n=t));return r}function l(e){for(var t,n,r=[],o=r,i=[],a=0,s=e.length;s>a;++a)switch(t=e[a],t[0]){case"#":case"^":o.push(t),i.push(t),o=t[4]=[];break;case"/":n=i.pop(),n[5]=t[2],o=i.length>0?i[i.length-1][4]:r;break;default:o.push(t)}return r}function c(e){this.string=e,this.tail=e,this.pos=0}function u(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function d(){this.cache={}}var h=Object.prototype.toString,f=Array.isArray||function(e){return"[object Array]"===h.call(e)},p=RegExp.prototype.test,m=/\S/,v={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},y=/\s*/,b=/\s+/,g=/\s*=/,w=/\s*\}/,N=/#|\^|\/|>|\{|&|=|!/;c.prototype.eos=function(){return""===this.tail},c.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var n=t[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n},c.prototype.scanUntil=function(e){var t,n=this.tail.search(e);switch(n){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,n),this.tail=this.tail.substring(n)}return this.pos+=t.length,t},u.prototype.push=function(e){return new u(e,this)},u.prototype.lookup=function(e){var n,r=this.cache;if(e in r)n=r[e];else{for(var o,i,a=this,s=!1;a;){if(e.indexOf(".")>0)for(n=a.view,o=e.split("."),i=0;null!=n&&i<o.length;)i===o.length-1&&null!=n&&(s="object"==typeof n&&n.hasOwnProperty(o[i])),n=n[o[i++]];else null!=a.view&&"object"==typeof a.view&&(n=a.view[e],s=a.view.hasOwnProperty(e));if(s)break;a=a.parent}r[e]=n}return t(n)&&(n=n.call(this.view)),n},d.prototype.clearCache=function(){this.cache={}},d.prototype.parse=function(e,t){var n=this.cache,r=n[e];return null==r&&(r=n[e]=a(e,t)),r},d.prototype.render=function(e,t,n){var r=this.parse(e),o=t instanceof u?t:new u(t);return this.renderTokens(r,o,n,e)},d.prototype.renderTokens=function(e,t,n,r){for(var o,i,a,s="",l=0,c=e.length;c>l;++l)a=void 0,o=e[l],i=o[0],"#"===i?a=this.renderSection(o,t,n,r):"^"===i?a=this.renderInverted(o,t,n,r):">"===i?a=this.renderPartial(o,t,n,r):"&"===i?a=this.unescapedValue(o,t):"name"===i?a=this.escapedValue(o,t):"text"===i&&(a=this.rawValue(o)),void 0!==a&&(s+=a);return s},d.prototype.renderSection=function(e,n,r,o){function i(e){return a.render(e,n,r)}var a=this,s="",l=n.lookup(e[1]);if(l){if(f(l))for(var c=0,u=l.length;u>c;++c)s+=this.renderTokens(e[4],n.push(l[c]),r,o);else if("object"==typeof l||"string"==typeof l||"number"==typeof l)s+=this.renderTokens(e[4],n.push(l),r,o);else if(t(l)){if("string"!=typeof o)throw new Error("Cannot use higher-order sections without the original template");l=l.call(n.view,o.slice(e[3],e[5]),i),null!=l&&(s+=l)}else s+=this.renderTokens(e[4],n,r,o);return s}},d.prototype.renderInverted=function(e,t,n,r){var o=t.lookup(e[1]);return!o||f(o)&&0===o.length?this.renderTokens(e[4],t,n,r):void 0},d.prototype.renderPartial=function(e,n,r){if(r){var o=t(r)?r(e[1]):r[e[1]];return null!=o?this.renderTokens(this.parse(o),n,r,o):void 0}},d.prototype.unescapedValue=function(e,t){var n=t.lookup(e[1]);return null!=n?n:void 0},d.prototype.escapedValue=function(t,n){var r=n.lookup(t[1]);return null!=r?e.escape(r):void 0},d.prototype.rawValue=function(e){return e[1]},e.name="mustache.js",e.version="2.0.0",e.tags=["{{","}}"];var k=new d;e.clearCache=function(){return k.clearCache()},e.parse=function(e,t){return k.parse(e,t)},e.render=function(e,t,n){return k.render(e,t,n)},e.to_html=function(n,r,o,i){var a=e.render(n,r,o);return t(i)?void i(a):a},e.escape=i,e.Scanner=c,e.Context=u,e.Writer=d}),function(){var t=function(e,n,r){var o=function(e,n,r){e.$observer||(e.$observer=this);var o=e.$observer,i=[];t.isArray(e)&&(0===e.length&&(e.$observeProps={},e.$observeProps.$observerPath="#"),o.mock(e));for(var a in e)e.hasOwnProperty(a)&&(r?t.isArray(n)&&t.isInArray(n,a)?(i.push(a),o.watch(e,a)):t.isString(n)&&a==n&&(i.push(a),o.watch(e,a)):(i.push(a),o.watch(e,a)));o.target=e,o.propertyChangedHandler||(o.propertyChangedHandler=[]);var s=r?r:n;o.propertyChangedHandler.push({all:!r,propChanged:s,eventPropArr:i})};return o.prototype={onPropertyChanged:function(e,n,r,o,i){if(n!==r&&this.propertyChangedHandler)for(var a=t._getRootName(e,i),s=0,l=this.propertyChangedHandler.length;l>s;s++){var c=this.propertyChangedHandler[s];(c.all||t.isInArray(c.eventPropArr,a)||0===a.indexOf("Array-"))&&c.propChanged.call(this.target,e,n,r,i)}0!==e.indexOf("Array-")&&"object"==typeof n&&this.watch(o,e,o.$observeProps.$observerPath)},mock:function(e){var n=this;e.forEach(function(e,t){e._nuclearIndex=t}),t.methods.forEach(function(r){e[r]=function(){var e=Array.prototype.slice.call(this,0),o=Array.prototype[r].apply(this,Array.prototype.slice.call(arguments));if(new RegExp("\\b"+r+"\\b").test(t.triggerStr)){this.forEach(function(e,t){e._nuclearIndex=t});for(var i in this)this.hasOwnProperty(i)&&!t.isFunction(this[i])&&n.watch(this,i,this.$observeProps.$observerPath);n.onPropertyChanged("Array-"+r,this,e,this,this.$observeProps.$observerPath)}return o}})},watch:function(e,n,r){if("$observeProps"!==n&&"$observer"!==n&&!t.isFunction(e[n])){e.$observeProps||(e.$observeProps={}),void 0!==r?e.$observeProps.$observerPath=r:e.$observeProps.$observerPath="#";var o=this,i=e.$observeProps[n]=e[n];if(Object.defineProperty(e,n,{get:function(){return this.$observeProps[n]},set:function(t){var r=this.$observeProps[n];this.$observeProps[n]=t,o.onPropertyChanged(n,t,r,this,e.$observeProps.$observerPath)}}),"object"==typeof i){t.isArray(i)&&(this.mock(i),0===i.length&&(i.$observeProps||(i.$observeProps={}),void 0!==r?i.$observeProps.$observerPath=r:i.$observeProps.$observerPath="#"));for(var a in i)i.hasOwnProperty(a)&&this.watch(i,a,e.$observeProps.$observerPath+"-"+n)}}}},new o(e,n,r)};t.methods=["concat","copyWithin","entries","every","fill","filter","find","findIndex","forEach","includes","indexOf","join","keys","lastIndexOf","map","pop","push","reduce","reduceRight","reverse","shift","slice","some","sort","splice","toLocaleString","toString","unshift","values","size"],t.triggerStr=["concat","copyWithin","fill","pop","push","reverse","shift","sort","splice","unshift","size"].join(","),t.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},t.isString=function(e){return"string"==typeof e},t.isInArray=function(e,t){for(var n=e.length;--n>-1;)if(t===e[n])return!0;return!1},t.isFunction=function(e){return"[object Function]"==Object.prototype.toString.call(e)},t.twoWay=function(e,n,r,o){"object"==typeof e[n]&&"object"==typeof r[o]?(t(e,n,function(e,t){r[o]=this[n]}),t(r,o,function(t,r){e[n]=this[o]})):(t(e,n,function(e,t){r[o]=t}),t(r,o,function(t,r){e[n]=r}))},t._getRootName=function(e,t){return"#"===t?e:t.split("-")[1]},t.add=function(e,t,n){e[t]=n;var r=e.$observer;r.watch(e,t)},Array.prototype.size=function(e){this.length=e},e.observe=t}(),e.Class=function(){},e.Class.extend=function(t){function n(){this.ctor.apply(this,arguments)}var r=Object.create(this.prototype);for(var o in t)r[o]=t[o];return n.prototype=r,n.prototype._super=Object.create(this.prototype),n.prototype.constructor=n,n.extend=e.Class.extend,n},function(){function t(){var e=document.createElement("style");e.appendChild(document.createTextNode("")),document.head.appendChild(e),e.sheet.insertRule("body { visibility: hidden; }",0),e.sheet.insertRule("template { display: none !important; }",0)}function n(e,t){var n=new RegExp("([^\r\n,{}]+)(,(?=[^}]*{)|s*{)","g");return e=e.replace(n,function(e,n,r){return n.match(/^\s*(@media|@keyframes|to|from|@font-face)/)?n+r:(n.match(/:scope/)&&(n=n.replace(/([^\s]*):scope/,function(e,t){return""===t?"> *":"> "+t})),n=n.replace(/^(\s*)/,"$1"+t+" "),n+r)})}function r(){var e=document.body.querySelectorAll("style[scoped]");if(0===e.length)return void(document.getElementsByTagName("body")[0].style.visibility="visible");var t=document.head||document.getElementsByTagName("head")[0];o&&t.removeChild(o),o=document.createElement("style");for(var r="",i=0;i<e.length;i++){var a=e[i],s=a.innerHTML;if(s&&"BODY"!==a.parentElement.nodeName){var l="nuclear-scoper-"+i,c="#"+l,u=a.parentNode;u.parentNode;u.id=l,a.parentNode.removeChild(a),r+=n(s,c)}}o.styleSheet?o.styleSheet.cssText=r:o.appendChild(document.createTextNode(r)),t.appendChild(o),
document.getElementsByTagName("body")[0].style.visibility="visible"}var o;return"scoped"in document.createElement("style")?void(e.refreshStyle=function(){}):(t(),"complete"===document.readyState||"loaded"===document.readyState?r():document.addEventListener("DOMContentLoaded",r),void(e.refreshStyle=r))}(),e});