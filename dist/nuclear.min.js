/* Nuclear  v0.2.14
 * By AlloyTeam http://www.alloyteam.com/
 * Github: https://github.com/AlloyTeam/Nuclear
 * MIT Licensed.
 */
!function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("Nuclear requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){var n={},r=e.document;return function(){"use strict";function t(e,t,n){!function(r){e[t]=e[n],e[n]=r}(e[t])}var i,o=function(e){var t=this;Object.keys(e).forEach(function(n){t[n]=e[n]})};o.prototype={toString:function(){return JSON.stringify(this)}};var a=function(e,t){this.oldValue=e,this.newValue=t};a.prototype={contains:function(e){return e.length<this.length?e.newValue>=this.newValue&&e.newValue<this.newValue+this.length:!1},toString:function(){return this.length+" element subset, first mapping: old "+this.oldValue+" â†’ new "+this.newValue}};var s=function(e){var t=[];return"#text"!==e.nodeName&&"#comment"!==e.nodeName&&(t.push(e.nodeName),e.attributes&&(e.attributes["class"]&&t.push(e.nodeName+"."+e.attributes["class"].replace(/ /g,".")),e.attributes.id&&t.push(e.nodeName+"#"+e.attributes.id))),t},l=function(e){var t={},n={};return e.forEach(function(e){s(e).forEach(function(e){var r=e in t,i=e in n;r||i?r&&(delete t[e],n[e]=!0):t[e]=!0})}),t},c=function(e,t){var n=l(e),r=l(t),i={};return Object.keys(n).forEach(function(e){r[e]&&(i[e]=!0)}),i},u=function(e){return delete e.outerDone,delete e.innerDone,delete e.valueDone,e.childNodes?e.childNodes.every(u):!0},d=function(e,t){var n,r;if(!["nodeName","value","checked","selected","data"].every(function(n){return e[n]===t[n]}))return!1;if(Boolean(e.attributes)!==Boolean(t.attributes))return!1;if(Boolean(e.childNodes)!==Boolean(t.childNodes))return!1;if(e.attributes){if(n=Object.keys(e.attributes),r=Object.keys(t.attributes),n.length!==r.length)return!1;if(!n.every(function(n){return e.attributes[n]!==t.attributes[n]?!1:void 0}))return!1}if(e.childNodes){if(e.childNodes.length!==t.childNodes.length)return!1;if(!e.childNodes.every(function(e,n){return d(e,t.childNodes[n])}))return!1}return!0},h=function(e,t,n,r,i){var o,a,s;if(!e||!t)return!1;if(e.nodeName!==t.nodeName)return!1;if("#text"===e.nodeName)return i?!0:e.data===t.data;if(e.nodeName in n)return!0;if(e.attributes&&t.attributes){if(e.attributes.id&&e.attributes.id===t.attributes.id){var l=e.nodeName+"#"+e.attributes.id;if(l in n)return!0}if(e.attributes["class"]&&e.attributes["class"]===t.attributes["class"]){var u=e.nodeName+"."+e.attributes["class"].replace(/ /g,".");if(u in n)return!0}}return r?!0:(a=e.childNodes?e.childNodes.slice().reverse():[],s=t.childNodes?t.childNodes.slice().reverse():[],a.length!==s.length?!1:i?a.every(function(e,t){return e.nodeName===s[t].nodeName}):(o=c(a,s),a.every(function(e,t){return h(e,s[t],o,!0,!0)})))},f=function(e){return JSON.parse(JSON.stringify(e))},p=function(e,t,n,r){var i,o,l=0,u=[],d=Array.apply(null,new Array(e.length+1)).map(function(){return[]}),f=c(e,t),p=e.length===t.length;return p&&e.some(function(e,n){var r=s(e),i=s(t[n]);return r.length!==i.length?(p=!1,!0):(r.some(function(e,t){return e!==i[t]?(p=!1,!0):void 0}),p?void 0:!0)}),e.forEach(function(e,i){t.forEach(function(t,o){n[i]||r[o]||!h(e,t,f,p)?d[i+1][o+1]=0:(d[i+1][o+1]=d[i][o]?d[i][o]+1:1,d[i+1][o+1]>=l&&(l=d[i+1][o+1],u=[i+1,o+1]))})}),0===l?!1:(i=[u[0]-l,u[1]-l],o=new a(i[0],i[1]),o.length=l,o)},v=function(e,t){return Array.apply(null,new Array(e)).map(function(){return t})},m=function(e,t,n){var r=e.childNodes?v(e.childNodes.length,!0):[],i=t.childNodes?v(t.childNodes.length,!0):[],o=0;return n.forEach(function(e){var t,n=e.oldValue+e.length,a=e.newValue+e.length;for(t=e.oldValue;n>t;t+=1)r[t]=o;for(t=e.newValue;a>t;t+=1)i[t]=o;o+=1}),{gaps1:r,gaps2:i}},y=function(e,t){for(var n=e.childNodes?e.childNodes:[],r=t.childNodes?t.childNodes:[],i=v(n.length,!1),o=v(r.length,!1),a=[],s=!0,l=function(){return arguments[1]},c=function(e){i[s.oldValue+e]=!0,o[s.newValue+e]=!0};s;)s=p(n,r,i,o),s&&(a.push(s),Array.apply(null,new Array(s.length)).map(l).forEach(c));return a},b=function(){this.list=[]};b.prototype={list:!1,add:function(e){var t=this.list;e.forEach(function(e){t.push(e)})},forEach:function(e){this.list.forEach(e)}};var g=function(e){var t,n={debug:!1,diffcap:10,maxDepth:!1,valueDiffing:!0,textDiff:function(){arguments[0].data=arguments[3]},preVirtualDiffApply:function(){},postVirtualDiffApply:function(){},preDiffApply:function(){},postDiffApply:function(){}};"undefined"==typeof e&&(e={});for(t in n)"undefined"==typeof e[t]?this[t]=n[t]:this[t]=e[t]};g.prototype={diff:function(e,t){var n=this.nodeToObj(e),r=this.nodeToObj(t);return i=0,this.debug&&(this.t1Orig=this.nodeToObj(e),this.t2Orig=this.nodeToObj(t)),this.tracker=new b,this.findDiffs(n,r)},findDiffs:function(t,n){var r;do{if(this.debug&&(i+=1,i>this.diffcap))throw e.diffError=[this.t1Orig,this.t2Orig],new Error("surpassed diffcap:"+JSON.stringify(this.t1Orig)+" -> "+JSON.stringify(this.t2Orig));r=this.findNextDiff(t,n,[]),0===r.length&&(d(t,n)||(u(t),r=this.findNextDiff(t,n,[]))),r.length>0&&(this.tracker.add(r),this.applyVirtual(t,r))}while(r.length>0);return this.tracker.list},findNextDiff:function(e,t,n){var r;if(this.maxDepth&&n.length>this.maxDepth)return[];if(!e.outerDone){if(r=this.findOuterDiff(e,t,n),r.length>0)return e.outerDone=!0,r;e.outerDone=!0}if(!e.innerDone){if(r=this.findInnerDiff(e,t,n),r.length>0)return r;e.innerDone=!0}if(this.valueDiffing&&!e.valueDone){if(r=this.findValueDiff(e,t,n),r.length>0)return e.valueDone=!0,r;e.valueDone=!0}return[]},findOuterDiff:function(e,t,n){var r,i,a=[];return e.nodeName!==t.nodeName?[new o({action:"replaceElement",oldValue:f(e),newValue:f(t),route:n})]:e.data!==t.data?"#text"===e.nodeName?[new o({action:"modifyComment",route:n,oldValue:e.data,newValue:t.data})]:[new o({action:"modifyTextElement",route:n,oldValue:e.data,newValue:t.data})]:(r=e.attributes?Object.keys(e.attributes).sort():[],i=t.attributes?Object.keys(t.attributes).sort():[],r.forEach(function(r){var s=i.indexOf(r);-1===s?a.push(new o({action:"removeAttribute",route:n,name:r,value:e.attributes[r]})):(i.splice(s,1),e.attributes[r]!==t.attributes[r]&&a.push(new o({action:"modifyAttribute",route:n,name:r,oldValue:e.attributes[r],newValue:t.attributes[r]})))}),i.forEach(function(e){a.push(new o({action:"addAttribute",route:n,name:e,value:t.attributes[e]}))}),a)},nodeToObj:function(e){var t={},n=this;return t.nodeName=e.nodeName,"#text"===t.nodeName||"#comment"===t.nodeName?t.data=e.data:(e.attributes&&e.attributes.length>0&&(t.attributes={},Array.prototype.slice.call(e.attributes).forEach(function(e){t.attributes[e.name]=e.value})),e.childNodes&&e.childNodes.length>0&&(t.childNodes=[],Array.prototype.slice.call(e.childNodes).forEach(function(e){t.childNodes.push(n.nodeToObj(e))})),this.valueDiffing&&(void 0!==e.value&&(t.value=e.value),void 0!==e.checked&&(t.checked=e.checked),void 0!==e.selected&&(t.selected=e.selected))),t},objToNode:function(e,t){var n,i=this;return"#text"===e.nodeName?n=r.createTextNode(e.data):"#comment"===e.nodeName?n=r.createComment(e.data):("svg"===e.nodeName||t?(n=r.createElementNS("http://www.w3.org/2000/svg",e.nodeName),t=!0):n=r.createElement(e.nodeName),e.attributes&&Object.keys(e.attributes).forEach(function(t){'=""'!==t&&n.setAttribute(t,e.attributes[t])}),e.childNodes&&e.childNodes.forEach(function(e){n.appendChild(i.objToNode(e,t))}),this.valueDiffing&&(e.value&&(n.value=e.value),e.checked&&(n.checked=e.checked),e.selected&&(n.selected=e.selected))),n},findInnerDiff:function(e,t,n){var r,i,a,s,l,c=e.childNodes&&t.childNodes?y(e,t):[],u=e.childNodes?e.childNodes:[],d=t.childNodes?t.childNodes:[],h=[],p=0;if(c.length>1)return this.attemptGroupRelocation(e,t,c,n);for(i=Math.max(u.length,d.length),u.length!==d.length&&(r=!0),l=0;i>l;l+=1)a=u[l],s=d[l],r&&(a&&!s?"#text"===a.nodeName?(h.push(new o({action:"removeTextElement",route:n.concat(p),value:a.data})),p-=1):(h.push(new o({action:"removeElement",route:n.concat(p),element:f(a)})),p-=1):s&&!a&&("#text"===s.nodeName?h.push(new o({action:"addTextElement",route:n.concat(p),value:s.data})):h.push(new o({action:"addElement",route:n.concat(p),element:f(s)})))),a&&s&&(h=h.concat(this.findNextDiff(a,s,n.concat(p)))),p+=1;return e.innerDone=!0,h},attemptGroupRelocation:function(e,t,n,r){var i,a,s,l,c,u,d,p,v,y=m(e,t,n),b=y.gaps1,g=y.gaps2,N=Math.min(b.length,g.length),w=[];for(p=0,d=0;N>p;d+=1,p+=1)if(b[p]===!0)if(l=e.childNodes[d],"#text"===l.nodeName){if("#text"===t.childNodes[p].nodeName&&l.data!==t.childNodes[p].data){for(u=d;e.childNodes.length>u+1&&"#text"===e.childNodes[u+1].nodeName;)if(u+=1,t.childNodes[p].data===e.childNodes[u].data){c=!0;break}c||w.push(new o({action:"modifyTextElement",route:r.concat(p),oldValue:l.data,newValue:t.childNodes[p].data}))}w.push(new o({action:"removeTextElement",route:r.concat(p),value:l.data})),b.splice(p,1),N=Math.min(b.length,g.length),p-=1}else w.push(new o({action:"removeElement",route:r.concat(p),element:f(l)})),b.splice(p,1),N=Math.min(b.length,g.length),p-=1;else if(g[p]===!0)l=t.childNodes[p],"#text"===l.nodeName?(w.push(new o({action:"addTextElement",route:r.concat(p),value:l.data})),b.splice(p,0,!0),N=Math.min(b.length,g.length),d-=1):(w.push(new o({action:"addElement",route:r.concat(p),element:f(l)})),b.splice(p,0,!0),N=Math.min(b.length,g.length),d-=1);else if(b[p]!==g[p]){if(w.length>0)return w;if(s=n[b[p]],a=Math.min(s.newValue,e.childNodes.length-s.length),a!==s.oldValue){for(i=!1,v=0;v<s.length;v+=1)h(e.childNodes[a+v],e.childNodes[s.oldValue+v],[],!1,!0)||(i=!0);if(i)return[new o({action:"relocateGroup",groupLength:s.length,from:s.oldValue,to:a,route:r})]}}return w},findValueDiff:function(e,t,n){var r=[];return e.selected!==t.selected&&r.push(new o({action:"modifySelected",oldValue:e.selected,newValue:t.selected,route:n})),(e.value||t.value)&&e.value!==t.value&&"OPTION"!==e.nodeName&&r.push(new o({action:"modifyValue",oldValue:e.value,newValue:t.value,route:n})),e.checked!==t.checked&&r.push(new o({action:"modifyChecked",oldValue:e.checked,newValue:t.checked,route:n})),r},applyVirtual:function(e,t){var n=this;return 0===t.length?!0:(t.forEach(function(t){n.applyVirtualDiff(e,t)}),!0)},getFromVirtualRoute:function(e,t){var n,r,i=e;for(t=t.slice();t.length>0;){if(!i.childNodes)return!1;r=t.splice(0,1)[0],n=i,i=i.childNodes[r]}return{node:i,parentNode:n,nodeIndex:r}},applyVirtualDiff:function(e,t){var n,r,i,o=this.getFromVirtualRoute(e,t.route),a=o.node,s=o.parentNode,l=o.nodeIndex,c={diff:t,node:a};if(this.preVirtualDiffApply(c))return!0;switch(t.action){case"addAttribute":a.attributes||(a.attributes={}),a.attributes[t.name]=t.value,"checked"===t.name?a.checked=!0:"selected"===t.name?a.selected=!0:"INPUT"===a.nodeName&&"value"===t.name&&(a.value=t.value);break;case"modifyAttribute":a.attributes[t.name]=t.newValue,"INPUT"===a.nodeName&&"value"===t.name&&(a.value=t.value);break;case"removeAttribute":delete a.attributes[t.name],0===Object.keys(a.attributes).length&&delete a.attributes,"checked"===t.name?delete a.checked:"selected"===t.name?delete a.selected:"INPUT"===a.nodeName&&"value"===t.name&&delete a.value;break;case"modifyTextElement":a.data=t.newValue,"TEXTAREA"===s.nodeName&&(s.value=t.newValue);break;case"modifyValue":a.value=t.newValue;break;case"modifyComment":a.data=t.newValue;break;case"modifyChecked":a.checked=t.newValue;break;case"modifySelected":a.selected=t.newValue;break;case"replaceElement":n=f(t.newValue),n.outerDone=!0,n.innerDone=!0,n.valueDone=!0,s.childNodes[l]=n;break;case"relocateGroup":a.childNodes.splice(t.from,t.groupLength).reverse().forEach(function(e){a.childNodes.splice(t.to,0,e)});break;case"removeElement":s.childNodes.splice(l,1);break;case"addElement":r=t.route.slice(),i=r.splice(r.length-1,1)[0],a=this.getFromVirtualRoute(e,r).node,n=f(t.element),n.outerDone=!0,n.innerDone=!0,n.valueDone=!0,a.childNodes||(a.childNodes=[]),i>=a.childNodes.length?a.childNodes.push(n):a.childNodes.splice(i,0,n);break;case"removeTextElement":s.childNodes.splice(l,1),"TEXTAREA"===s.nodeName&&delete s.value;break;case"addTextElement":r=t.route.slice(),i=r.splice(r.length-1,1)[0],n={},n.nodeName="#text",n.data=t.value,a=this.getFromVirtualRoute(e,r).node,a.childNodes||(a.childNodes=[]),i>=a.childNodes.length?a.childNodes.push(n):a.childNodes.splice(i,0,n),"TEXTAREA"===a.nodeName&&(a.value=t.newValue);break;default:console.log("unknown action")}c.newNode=n,this.postVirtualDiffApply(c)},apply:function(e,t){var n=this;return 0===t.length?!0:(t.forEach(function(t){return n.applyDiff(e,t)?void 0:!1}),!0)},getFromRoute:function(e,t){t=t.slice();for(var n,r=e;t.length>0;){if(!r.childNodes)return!1;n=t.splice(0,1)[0],r=r.childNodes[n]}return r},applyDiff:function(e,t){var n,i,o,a,s=this.getFromRoute(e,t.route),l={diff:t,node:s};if(this.preDiffApply(l))return!0;switch(t.action){case"addAttribute":if(!s||!s.setAttribute)return!1;if('"'===t.name||'="'===t.name||'=""'===t.name)break;s.setAttribute(t.name,t.value);break;case"modifyAttribute":if(!s||!s.setAttribute)return!1;s.setAttribute(t.name,t.newValue);break;case"removeAttribute":if(!s||!s.removeAttribute)return!1;s.removeAttribute(t.name);break;case"modifyTextElement":if(!s||3!==s.nodeType)return!1;this.textDiff(s,s.data,t.oldValue,t.newValue);break;case"modifyValue":if(!s||"undefined"==typeof s.value)return!1;s.value=t.newValue;break;case"modifyComment":if(!s||"undefined"==typeof s.data)return!1;this.textDiff(s,s.data,t.oldValue,t.newValue);break;case"modifyChecked":if(!s||"undefined"==typeof s.checked)return!1;s.checked=t.newValue;break;case"modifySelected":if(!s||"undefined"==typeof s.selected)return!1;s.selected=t.newValue;break;case"replaceElement":s.parentNode.replaceChild(this.objToNode(t.newValue,"http://www.w3.org/2000/svg"===s.namespaceURI),s);break;case"relocateGroup":Array.apply(null,new Array(t.groupLength)).map(function(){return s.removeChild(s.childNodes[t.from])}).forEach(function(e,n){0===n&&(i=s.childNodes[t.to]),s.insertBefore(e,i)});break;case"removeElement":s.parentNode.removeChild(s);break;case"addElement":o=t.route.slice(),a=o.splice(o.length-1,1)[0],s=this.getFromRoute(e,o),s.insertBefore(this.objToNode(t.element,"http://www.w3.org/2000/svg"===s.namespaceURI),s.childNodes[a]);break;case"removeTextElement":if(!s||3!==s.nodeType)return!1;s.parentNode.removeChild(s);break;case"addTextElement":if(o=t.route.slice(),a=o.splice(o.length-1,1)[0],n=r.createTextNode(t.value),s=this.getFromRoute(e,o),!s||!s.childNodes)return!1;s.insertBefore(n,s.childNodes[a]);break;default:console.log("unknown action")}return l.newNode=n,this.postDiffApply(l),!0},undo:function(e,t){t=t.slice();var n=this;t.length||(t=[t]),t.reverse(),t.forEach(function(t){n.undoDiff(e,t)})},undoDiff:function(e,n){switch(n.action){case"addAttribute":n.action="removeAttribute",this.applyDiff(e,n);break;case"modifyAttribute":t(n,"oldValue","newValue"),this.applyDiff(e,n);break;case"removeAttribute":n.action="addAttribute",this.applyDiff(e,n);break;case"modifyTextElement":t(n,"oldValue","newValue"),this.applyDiff(e,n);break;case"modifyValue":t(n,"oldValue","newValue"),this.applyDiff(e,n);break;case"modifyComment":t(n,"oldValue","newValue"),this.applyDiff(e,n);break;case"modifyChecked":t(n,"oldValue","newValue"),this.applyDiff(e,n);break;case"modifySelected":t(n,"oldValue","newValue"),this.applyDiff(e,n);break;case"replaceElement":t(n,"oldValue","newValue"),this.applyDiff(e,n);break;case"relocateGroup":t(n,"from","to"),this.applyDiff(e,n);break;case"removeElement":n.action="addElement",this.applyDiff(e,n);break;case"addElement":n.action="removeElement",this.applyDiff(e,n);break;case"removeTextElement":n.action="addTextElement",this.applyDiff(e,n);break;case"addTextElement":n.action="removeTextElement",this.applyDiff(e,n);break;default:console.log("unknown action")}}},n.diffDOM=new g}.call(this),n.create=function(e,t){e._nuclearSetting=t||{},n._mixObj(e);var r=this===n?n.Class:this,i=r.extend(e);return i.create=n.create,i},n._mixObj=function(t){t.ctor=function(t,i){this._nuclearTwoWay=!0,this._nuclearDiffDom=!0,this._nuclearServerRender=this._nuclearSetting.server,(this._nuclearSetting.twoWay===!1||this._nuclearServerRender)&&(this._nuclearTwoWay=!1),this._nuclearSetting.diff===!1&&(this._nuclearDiffDom=!1),this._nuclearReRender="string"==typeof t,this._nuclearReRender?(this.parentNode=r.querySelector(t).firstChild,this._ncInstanceId=this.parentNode.getAttribute("data-nuclearId"),this._nuclearOption=JSON.parse(this.parentNode.querySelector("input[name=__nuclear_option_"+this._ncInstanceId+"]").value)):this._nuclearServerRender?(this._ncInstanceId=n.getServerInstanceId(),this._nuclearOption=t):(this._ncInstanceId=n.getInstanceId(),this._nuclearOption=t),e.Nuclear.instances[this._ncInstanceId]=this,this._nuclearParentEmpty=!i,this.HTML="",Object.defineProperty(this,"option",{get:function(){return this._nuclearOption},set:function(e){var t=this._nuclearOption;t!==e&&(this._nuclearOption=e,this.onOptionChange&&this.onOptionChange("_nuclearOption",e,t,""),this._nuclearObserver(),this._nuclearRenderInfo.data=this.option,this.refresh())}}),this.option["@item"]=function(){return JSON.stringify(this)},this._nuclearReRender||(this._nuclearParentEmpty?this.parentNode=r.createElement("div"):(this.parentNode="string"==typeof i?r.querySelector(i):i,r.body===this.parentNode&&(this.parentNode=r.createElement("div"),r.body.appendChild(this.parentNode)))),this.install&&this.install(),this._nuclearRef=[];for(var o in this)this.hasOwnProperty(o)&&this[o]&&this[o]._nuclearLocalRefresh&&(this[o]._nuclearParent=this,this._nuclearRef.push(this[o]));this._nuclearTimer=null,this._preNuclearTime=new Date,this._nuclearObserver(),this._nuclearRenderInfo={tpl:this._nuclearTplGenerator(),data:this.option,parent:this.parentNode},this._nuclearRender(this._nuclearRenderInfo),this.installed&&this.installed()},t._nuclearObserver=function(){this.option&&this._nuclearTwoWay&&n.observe(this.option,function(e,t,n,r){(!this.onOptionChange||this.onOptionChange&&this.onOptionChange(e,t,n,r)!==!1)&&(clearTimeout(this._nuclearTimer),new Date-this._preNuclearTime>40?(this._nuclearLocalRefresh(),this._preNuclearTime=new Date):this._nuclearTimer=setTimeout(function(){this._nuclearLocalRefresh()}.bind(this),40))}.bind(this))},t.refresh=function(){this._nuclearLocalRefresh()},t.setNuclearContainer=function(e){if(this.parentNode="string"==typeof e?r.querySelector(e):e,r.body!==this.parentNode)for(;this.parentNode.firstChild;)this.parentNode.removeChild(this.parentNode.firstChild);this._nuclearRenderInfo.parent=this.parentNode,this.parentNode.innerHTML=this.HTML,this.node=this.parentNode.lastChild,this._mixNode()},t.render&&(t._nuclearTplGenerator=t.render),t.render=function(){return this._nuclearParentEmpty?this.HTML:this._nuclearTplGenerator()},t._nuclearSetStyleData=function(){if(this.node&&this.node.querySelector)for(var e=this.node.querySelectorAll("style"),t=0,i=e.length;i>t;t++){var o=e[t];o.setAttribute("data-nuclearId",this._ncInstanceId);var a=n.scoper(o.innerHTML,"#nuclear-scoper-"+this._ncInstanceId);o.innerHTML="",o.styleSheet?o.styleSheet.cssText=a:o.appendChild(r.createTextNode(a))}},t._nuclearRender=function(e){var t=!1;if(this.node)if(n.isUndefined(e.tpl))e.parent.removeChild(this.node),this.node=null,this.HTML="";else{var r=n.str2Dom(this._nuclearWrap(n.render(n._fixEvent(n._fixTplIndex(e.tpl),this._ncInstanceId),e.data)));this._nuclearDiffDom?n.diffDOM.apply(this.node,n.diffDOM.diff(this.node,r)):(e.parent.replaceChild(r,this.node),this.node=r)}else n.isUndefined(e.tpl)||(t=!0,e.parent.innerHTML=this._nuclearWrap(n.render(n._fixEvent(n._fixTplIndex(e.tpl),this._ncInstanceId),e.data)),this.node=e.parent.lastChild);this.node&&(this.node.setAttribute("data-nuclearId",this._ncInstanceId),this._mixNode(),e.refreshPart=this.node.querySelectorAll("*[nc-refresh]"),this.HTML=this.node.outerHTML,this._nuclearFix(),this.onRefresh&&this.onRefresh()),this._nuclearSetStyleData(),n.refreshStyle(this._ncInstanceId)},t._mixNode=function(){var e=this.node.querySelectorAll("*[nc-id]"),t=e.length;if(t>0)for(var n=0;t>n;n++){var r=e[n];this[r.getAttribute("nc-id")]=r}var i=this.node.querySelectorAll("*[nc-class]"),o=i.length;if(o>0){for(var a=0;o>a;a++){var s=i[a],l=s.getAttribute("nc-class");this[l]=[]}for(a=0;o>a;a++){var s=i[a],l=s.getAttribute("nc-class");this[l].push(s)}}},t._nuclearFix=function(){this._nuclearParent||this._nuclearFixOne(this)},t._nuclearFixOne=function(e){var t=e._nuclearRef.length;if(t>0)for(var n=0;t>n;n++){var r=e._nuclearRef[n];r.node=e.node.querySelector('*[data-nuclearId="'+r._ncInstanceId+'"]'),r.node&&(r._mixNode(),r._nuclearRenderInfo.refreshPart=r.node.querySelectorAll("*[nc-refresh]"),r._nuclearRenderInfo.parent=r.node.parentNode,this._nuclearFixOne(r),r.onRefresh&&r.onRefresh(),r.installed&&r.installed())}},t._nuclearWrap=function(e){var t="",n="";return this.style&&(t="<style scoped data-nuclearId="+this._ncInstanceId+">"+this.style()+"</style>"),this._nuclearServerRender&&(n=this._nuclearViewOption(this._ncInstanceId,JSON.stringify(this.option))),"<div "+(this._nuclearServerRender?'data-server="server"':"")+">"+t+e+n+"</div>"},t._nuclearViewOption=function(e,t){return'<input type="hidden" name="__nuclear_option_'+e+"\"  value='"+t+"'>"},t._nuclearLocalRefresh=function(){var e=this._nuclearRenderInfo,t=e.refreshPart.length;if(e.tpl=this._nuclearTplGenerator(),t>0){for(var r=n.str2Dom(this._nuclearWrap(n.render(n._fixEvent(n._fixTplIndex(e.tpl),this._ncInstanceId),e.data))).querySelectorAll("*[nc-refresh]"),i=0;t>i;i++){var o=e.refreshPart[i];o.parentNode&&o.parentNode.replaceChild(r[i],o)}e.refreshPart=r,this._mixNode(),this.HTML=this.node.outerHTML,this._nuclearFix(),this.onRefresh&&this.onRefresh(),n.refreshStyle(this._ncInstanceId)}else this._nuclearRender(e)}},n._fixEvent=function(e,t){return e.replace(/<[\s\S]*?>/g,function(e){return e.replace(/(onabort|onblur|oncancel|oncanplay|oncanplaythrough|onchange|onclick|onclose|oncontextmenu|oncuechange|ondblclick|ondrag|ondragend|ondragenter|ondragleave|ondragover|ondragstart|ondrop|ondurationchange|onemptied|onended|onerror|onfocus|oninput|oninvalid|onkeydown|onkeypress|onkeyup|onload|onloadeddata|onloadedmetadata|onloadstart|onmousedown|onmouseenter|onmouseleave|onmousemove|onmouseout|onmouseover|onmouseup|onmousewheel|onpause|onplay|onplaying|onprogress|onratechange|onreset|onresize|onscroll|onseeked|onseeking|onselect|onshow|onstalled|onsubmit|onsuspend|ontimeupdate|ontoggle|onvolumechange|onwaiting|onautocomplete|onautocompleteerror|onbeforecopy|onbeforecut|onbeforepaste|oncopy|oncut|onpaste|onsearch|onselectstart|onwheel|onwebkitfullscreenchange|onwebkitfullscreenerror|ontouchstart|ontouchmove|ontouchend|ontouchcancel|onpointerdown|onpointerup|onpointercancel|onpointermove|onpointerover|onpointerout|onpointerenter|onpointerleave)=('|")/g,function(e,n,r,i,o){return"Nuclear.instances["===o.substr(e.length+i,18)?e:e+="Nuclear.instances["+t+"]."})})},n._fixTplIndex=function(e){return e.replace(/{{@index}}/g,"{{_nuclearIndex}}")},n.str2Dom=function(e){var t={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],body:[0,"",""],_default:[1,"<div>","</div>"]};t.optgroup=t.option,t.tbody=t.tfoot=t.colgroup=t.caption=t.thead,t.th=t.td;var n=/<\s*\w.*?>/g.exec(e),i=r.createElement("div");if(null!=n){var o=n[0].replace(/</g,"").replace(/>/g,"").split(" ")[0];if("body"===o.toLowerCase()){var a=r.createElement("body");i.innerHTML=e.replace(/<body/g,"<div").replace(/<\/body>/g,"</div>");var s=i.firstChild.attributes;a.innerHTML=e;for(var l=0;l<s.length;l++)a.setAttribute(s[l].name,s[l].value);return a}var c=t[o]||t._default;e=c[1]+e+c[2],i.innerHTML=e;for(var u=c[0]+1;u--;)i=i.lastChild}else i.innerHTML=e,i=i.lastChild;return i},n.isUndefined=function(e){return"undefined"==typeof e},n._serverInstanceId=1e6,n.getServerInstanceId=function(){return n._serverInstanceId>1e7&&!n.instances[1e6]&&(n._serverInstanceId=1e6),n._serverInstanceId++},n._instanceId=0,n.getInstanceId=function(){if(n._instanceId>n._serverInstanceId)throw"please set _serverInstanceId value to a larger value";return n._instanceId++},n.instances={},n.destroy=function(e){n.instances[e._ncInstanceId]=null},function(e,t){n.Tpl={},t(n.Tpl),n.render=n.Tpl.render}(this,function(e){function t(e){return"function"==typeof e}function n(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function r(e,t){return p.call(e,t)}function i(e){return!r(v,e)}function o(e){return String(e).replace(/[&<>"'\/]/g,function(e){return m[e]})}function a(t,r){function o(){if(_&&!k)for(;m.length;)delete v[m.pop()];else m=[];_=!1,k=!1}function a(e){if("string"==typeof e&&(e=e.split(b,2)),!f(e)||2!==e.length)throw new Error("Invalid tags: "+e);u=new RegExp(n(e[0])+"\\s*"),d=new RegExp("\\s*"+n(e[1])),h=new RegExp("\\s*"+n("}"+e[1]))}if(!t)return[];var u,d,h,p=[],v=[],m=[],_=!1,k=!1;a(r||e.tags);for(var x,E,I,T,V,D,A=new c(t);!A.eos();){if(x=A.pos,I=A.scanUntil(u))for(var O=0,S=I.length;S>O;++O)T=I.charAt(O),i(T)?m.push(v.length):k=!0,v.push(["text",T,x,x+1]),x+=1,"\n"===T&&o();if(!A.scan(u))break;if(_=!0,E=A.scan(w)||"name",A.scan(y),"="===E?(I=A.scanUntil(g),A.scan(g),A.scanUntil(d)):"{"===E?(I=A.scanUntil(h),A.scan(N),A.scanUntil(d),E="&"):I=A.scanUntil(d),!A.scan(d))throw new Error("Unclosed tag at "+A.pos);if(V=[E,I,x,A.pos],v.push(V),"#"===E||"^"===E)p.push(V);else if("/"===E){if(D=p.pop(),!D)throw new Error('Unopened section "'+I+'" at '+x);if(D[1]!==I)throw new Error('Unclosed section "'+D[1]+'" at '+x)}else"name"===E||"{"===E||"&"===E?k=!0:"="===E&&a(I)}if(D=p.pop())throw new Error('Unclosed section "'+D[1]+'" at '+A.pos);return l(s(v))}function s(e){for(var t,n,r=[],i=0,o=e.length;o>i;++i)t=e[i],t&&("text"===t[0]&&n&&"text"===n[0]?(n[1]+=t[1],n[3]=t[3]):(r.push(t),n=t));return r}function l(e){for(var t,n,r=[],i=r,o=[],a=0,s=e.length;s>a;++a)switch(t=e[a],t[0]){case"#":case"^":i.push(t),o.push(t),i=t[4]=[];break;case"/":n=o.pop(),n[5]=t[2],i=o.length>0?o[o.length-1][4]:r;break;default:i.push(t)}return r}function c(e){this.string=e,this.tail=e,this.pos=0}function u(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function d(){this.cache={}}var h=Object.prototype.toString,f=Array.isArray||function(e){return"[object Array]"===h.call(e)},p=RegExp.prototype.test,v=/\S/,m={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},y=/\s*/,b=/\s+/,g=/\s*=/,N=/\s*\}/,w=/#|\^|\/|>|\{|&|=|!/;c.prototype.eos=function(){return""===this.tail},c.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var n=t[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n},c.prototype.scanUntil=function(e){var t,n=this.tail.search(e);switch(n){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,n),this.tail=this.tail.substring(n)}return this.pos+=t.length,t},u.prototype.push=function(e){return new u(e,this)},u.prototype.lookup=function(e){var n,r=this.cache;if(e in r)n=r[e];else{for(var i,o,a=this,s=!1;a;){if(e.indexOf(".")>0)for(n=a.view,i=e.split("."),o=0;null!=n&&o<i.length;)o===i.length-1&&null!=n&&(s="object"==typeof n&&n.hasOwnProperty(i[o])),n=n[i[o++]];else null!=a.view&&"object"==typeof a.view&&(n=a.view[e],s=a.view.hasOwnProperty(e));if(s)break;a=a.parent}r[e]=n}return t(n)&&(n=n.call(this.view)),n},d.prototype.clearCache=function(){this.cache={}},d.prototype.parse=function(e,t){var n=this.cache,r=n[e];return null==r&&(r=n[e]=a(e,t)),r},d.prototype.render=function(e,t,n){var r=this.parse(e),i=t instanceof u?t:new u(t);return this.renderTokens(r,i,n,e)},d.prototype.renderTokens=function(e,t,n,r){for(var i,o,a,s="",l=0,c=e.length;c>l;++l)a=void 0,i=e[l],o=i[0],"#"===o?a=this.renderSection(i,t,n,r):"^"===o?a=this.renderInverted(i,t,n,r):">"===o?a=this.renderPartial(i,t,n,r):"&"===o?a=this.unescapedValue(i,t):"name"===o?a=this.escapedValue(i,t):"text"===o&&(a=this.rawValue(i)),void 0!==a&&(s+=a);return s},d.prototype.renderSection=function(e,n,r,i){function o(e){return a.render(e,n,r)}var a=this,s="",l=n.lookup(e[1]);if(l){if(f(l))for(var c=0,u=l.length;u>c;++c)s+=this.renderTokens(e[4],n.push(l[c]),r,i);else if("object"==typeof l||"string"==typeof l||"number"==typeof l)s+=this.renderTokens(e[4],n.push(l),r,i);else if(t(l)){if("string"!=typeof i)throw new Error("Cannot use higher-order sections without the original template");l=l.call(n.view,i.slice(e[3],e[5]),o),null!=l&&(s+=l)}else s+=this.renderTokens(e[4],n,r,i);return s}},d.prototype.renderInverted=function(e,t,n,r){var i=t.lookup(e[1]);return!i||f(i)&&0===i.length?this.renderTokens(e[4],t,n,r):void 0},d.prototype.renderPartial=function(e,n,r){if(r){var i=t(r)?r(e[1]):r[e[1]];return null!=i?this.renderTokens(this.parse(i),n,r,i):void 0}},d.prototype.unescapedValue=function(e,t){var n=t.lookup(e[1]);return null!=n?n:void 0},d.prototype.escapedValue=function(t,n){var r=n.lookup(t[1]);return null!=r?e.escape(r):void 0},d.prototype.rawValue=function(e){return e[1]},e.name="mustache.js",e.version="2.0.0",e.tags=["{{","}}"];var _=new d;e.clearCache=function(){return _.clearCache()},e.parse=function(e,t){return _.parse(e,t)},e.render=function(e,t,n){return _.render(e,t,n)},e.to_html=function(n,r,i,o){var a=e.render(n,r,i);return t(o)?void o(a):a},e.escape=o,e.Scanner=c,e.Context=u,e.Writer=d}),function(){var e=function(t,n,r){var i=function(t,n,r){t.$observer||(t.$observer=this);var i=t.$observer,o=[];e.isArray(t)&&(0===t.length&&(t.$observeProps={},t.$observeProps.$observerPath="#"),i.mock(t));for(var a in t)t.hasOwnProperty(a)&&(r?e.isArray(n)&&e.isInArray(n,a)?(o.push(a),i.watch(t,a)):e.isString(n)&&a==n&&(o.push(a),i.watch(t,a)):(o.push(a),i.watch(t,a)));i.target=t,i.propertyChangedHandler||(i.propertyChangedHandler=[]);var s=r?r:n;i.propertyChangedHandler.push({all:!r,propChanged:s,eventPropArr:o})};return i.prototype={onPropertyChanged:function(t,n,r,i,o){if(n!==r&&this.propertyChangedHandler)for(var a=e._getRootName(t,o),s=0,l=this.propertyChangedHandler.length;l>s;s++){var c=this.propertyChangedHandler[s];(c.all||e.isInArray(c.eventPropArr,a)||0===a.indexOf("Array-"))&&c.propChanged.call(this.target,t,n,r,o)}0!==t.indexOf("Array-")&&"object"==typeof n&&this.watch(i,t,i.$observeProps.$observerPath)},mock:function(t){var n=this;t.forEach(function(e,t){e._nuclearIndex=t}),e.methods.forEach(function(r){t[r]=function(){var t=Array.prototype.slice.call(this,0),i=Array.prototype[r].apply(this,Array.prototype.slice.call(arguments));if(new RegExp("\\b"+r+"\\b").test(e.triggerStr)){this.forEach(function(e,t){e._nuclearIndex=t});for(var o in this)this.hasOwnProperty(o)&&!e.isFunction(this[o])&&n.watch(this,o,this.$observeProps.$observerPath);n.onPropertyChanged("Array-"+r,this,t,this,this.$observeProps.$observerPath)}return i},t["real"+r.substring(0,1).toUpperCase()+r.substring(1)]=function(){return Array.prototype[r].apply(this,Array.prototype.slice.call(arguments))}})},watch:function(t,n,r){if("$observeProps"!==n&&"$observer"!==n&&!e.isFunction(t[n])){t.$observeProps||(t.$observeProps={}),void 0!==r?t.$observeProps.$observerPath=r:t.$observeProps.$observerPath="#";var i=this,o=t.$observeProps[n]=t[n];if(Object.defineProperty(t,n,{get:function(){return this.$observeProps[n]},set:function(e){var r=this.$observeProps[n];this.$observeProps[n]=e,i.onPropertyChanged(n,e,r,this,t.$observeProps.$observerPath)}}),"object"==typeof o){e.isArray(o)&&(this.mock(o),0===o.length&&(o.$observeProps||(o.$observeProps={}),void 0!==r?o.$observeProps.$observerPath=r:o.$observeProps.$observerPath="#"));for(var a in o)o.hasOwnProperty(a)&&this.watch(o,a,t.$observeProps.$observerPath+"-"+n)}}}},new i(t,n,r)};e.methods=["concat","copyWithin","entries","every","fill","filter","find","findIndex","forEach","includes","indexOf","join","keys","lastIndexOf","map","pop","push","reduce","reduceRight","reverse","shift","slice","some","sort","splice","toLocaleString","toString","unshift","values","size"],
e.triggerStr=["concat","copyWithin","fill","pop","push","reverse","shift","sort","splice","unshift","size"].join(","),e.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},e.isString=function(e){return"string"==typeof e},e.isInArray=function(e,t){for(var n=e.length;--n>-1;)if(t===e[n])return!0;return!1},e.isFunction=function(e){return"[object Function]"==Object.prototype.toString.call(e)},e._getRootName=function(e,t){return"#"===t?e:t.split("-")[1]},e.add=function(e,t,n){e[t]=n;var r=e.$observer;r.watch(e,t)},Array.prototype.size=function(e){this.length=e},n.observe=e}(),n.Class=function(){},n.Class.extend=function(e){function t(){this.ctor.apply(this,arguments)}var r=Object.create(this.prototype);for(var i in e)r[i]=e[i];return t.prototype=r,t.prototype._super=Object.create(this.prototype),t.prototype.constructor=t,t.extend=n.Class.extend,t},function(){function e(){var e=r.createElement("style");e.appendChild(r.createTextNode("")),r.head.appendChild(e),e.sheet.insertRule("body { visibility: hidden; }",0),e.sheet.insertRule("template { display: none !important; }",0)}function t(e,t){var n=new RegExp("([^\r\n,{}]+)(,(?=[^}]*{)|s*{)","g");return e=e.replace(n,function(e,n,r){return n.match(/^\s*(@media|@keyframes|to|from|@font-face)/)?n+r:(n.match(/:scope/)&&(n=n.replace(/([^\s]*):scope/,function(e,t){return""===t?"> *":"> "+t})),n=n.replace(/^(\s*)/,"$1"+t+" "),n+r)})}function i(){var e=r.body.querySelectorAll("style[scoped]");if(0===e.length)return void(r.getElementsByTagName("body")[0].style.visibility="visible");for(var t=r.head||r.getElementsByTagName("head")[0],n=0;n<e.length;n++){var i=r.createElement("style"),o="",a=e[n],s=a.getAttribute("data-nuclearId"),l=a.innerHTML;if(i.setAttribute("data-scoper-nuclearId",s),l&&"BODY"!==a.parentElement.nodeName){var c="nuclear-scoper-"+s,u=a.parentNode;u.id=c,a.parentNode.removeChild(a),o+=l}i.styleSheet?i.styleSheet.cssText=o:i.appendChild(r.createTextNode(o)),t.appendChild(i)}r.getElementsByTagName("body")[0].style.visibility="visible"}n.scoper=t,n.refreshStyle=function(){},"scoped"in r.createElement("style")||(e(),"complete"===r.readyState||"loaded"===r.readyState?i():r.addEventListener("DOMContentLoaded",i),n.refreshStyle=function(e){var t=r.querySelector('style[data-scoper-nuclearId="'+e+'"]');t&&t.parentNode.removeChild(t),i()})}(),t||e.Nuclear&&e.Nuclear.instances||(e.Nuclear=n),n});