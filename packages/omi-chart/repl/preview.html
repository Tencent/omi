<!DOCTYPE html>
<html>

<head lang="en">
  <meta charset="UTF-8">
  <title></title>
  <script src="https://www.chartjs.org/dist/2.7.3/Chart.bundle.js"></script>
  <script src="https://unpkg.com/omi"></script>
  <script>
    var createElement = Omi.createElement
    var define = Omi.define
    var WeElement = Omi.WeElement
    var render = Omi.render

    class ChartBase extends WeElement {
      receiveProps(props) {
        this.chart.data = props.data
        this.chart.options = props.options
        this.chart.update()
      }

      render(props) {
        return createElement(
          'div',
          { style: { width: props.width + 'px', height: props.height + 'px' } },
          createElement(
            'canvas',
            {
              ref: e => {
                this.canvas = e;
              }
            }
          )
        )
      }
    }

    define('chart-bar', class extends ChartBase {
      installed() {
        this.chart = new Chart(this.canvas.getContext('2d'), {
          type: this.props.horizontal ? 'horizontalBar' : 'bar',
          data: this.props.data,
          options: this.props.options
        })
      }
    })


    define('chart-line', class extends ChartBase {
      installed() {
        this.chart = new Chart(this.canvas.getContext('2d'), {
          type: 'line',
          data: this.props.data,
          options: this.props.options
        })
      }
    })

    define('chart-radar', class extends ChartBase {
      installed() {
        this.chart = new Chart(this.canvas.getContext('2d'), {
          type: 'radar',
          data: this.props.data,
          options: this.props.options
        })
      }
    })

    define('chart-scatter', class extends ChartBase {
      installed() {
        this.chart = new Chart.Scatter(this.canvas.getContext('2d'), {
          data: this.props.data,
          options: this.props.options
        })
      }
    })

    define('chart-doughnut', class extends ChartBase {
      installed() {
        this.chart = new Chart(this.canvas.getContext('2d'), {
          type: 'doughnut',
          data: this.props.data,
          options: this.props.options
        })
      }
    })
  </script>
</head>

<body style="background-color:#eee;">

  <script>
    var script = document.createElement("script");
    script.innerHTML = parent._sourceCode;
    document.body.appendChild(script)
  </script>
</body>

</html>